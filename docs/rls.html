<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Capítulo 7 Regresión lineal simple | Notas de métodos estadísticos</title>
  <meta name="description" content="Notas de clase de métodos estadísticos." />
  <meta name="generator" content="bookdown 0.43 and GitBook 2.6.7" />

  <meta property="og:title" content="Capítulo 7 Regresión lineal simple | Notas de métodos estadísticos" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Notas de clase de métodos estadísticos." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Capítulo 7 Regresión lineal simple | Notas de métodos estadísticos" />
  
  <meta name="twitter:description" content="Notas de clase de métodos estadísticos." />
  

<meta name="author" content="Carlos de Oro Aguado" />


<meta name="date" content="2025-09-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="correglin.html"/>
<link rel="next" href="referencias-1.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/codefolding-lua-1.1/codefolding-lua.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Notas de métodos estadísticos</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Asignatura</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introducción</a>
<ul>
<li class="chapter" data-level="1.1" data-path="07-rls.html"><a href="#introducci%C3%B3n-a-r-y-rstudio"><i class="fa fa-check"></i><b>1.1</b> Introducción a R y RStudio</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="07-rls.html"><a href="#qu%C3%A9-es-r"><i class="fa fa-check"></i><b>1.1.1</b> ¿Qué es R?</a></li>
<li class="chapter" data-level="1.1.2" data-path="07-rls.html"><a href="#qu%C3%A9-es-rstudio"><i class="fa fa-check"></i><b>1.1.2</b> ¿Qué es RStudio?</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="07-rls.html"><a href="#introducci%C3%B3n-a-git-y-github"><i class="fa fa-check"></i><b>1.2</b> Introducción a Git y GitHub</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="07-rls.html"><a href="#qu%C3%A9-es-git"><i class="fa fa-check"></i><b>1.2.1</b> ¿Qué es Git?</a></li>
<li class="chapter" data-level="1.2.2" data-path="07-rls.html"><a href="#qu%C3%A9-es-github"><i class="fa fa-check"></i><b>1.2.2</b> ¿Qué es GitHub?</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="07-rls.html"><a href="#introducci%C3%B3n-a-tidyverse"><i class="fa fa-check"></i><b>1.3</b> Introducción a Tidyverse</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="07-rls.html"><a href="#representaci%C3%B3n-visual-del-ecosistema-tidyverse"><i class="fa fa-check"></i><b>1.3.1</b> Representación visual del ecosistema Tidyverse</a></li>
<li class="chapter" data-level="1.3.2" data-path="intro.html"><a href="intro.html#principales-paquetes-del-tidyverse"><i class="fa fa-check"></i><b>1.3.2</b> Principales paquetes del Tidyverse</a></li>
<li class="chapter" data-level="1.3.3" data-path="07-rls.html"><a href="#instalaci%C3%B3n-del-tidyverse-en-r"><i class="fa fa-check"></i><b>1.3.3</b> Instalación del Tidyverse en R</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#pasos-para-publicar-un-libro-bookdown-en-github-pages"><i class="fa fa-check"></i><b>1.4</b> Pasos para publicar un libro <code>bookdown</code> en GitHub Pages</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="07-rls.html"><a href="#video-paso-a-paso-de-la-publicaci%C3%B3n-del-libro-en-github-pages"><i class="fa fa-check"></i><b>1.4.1</b> Video paso a paso de la publicación del libro en GitHub Pages</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="reglas.html"><a href="reglas.html"><i class="fa fa-check"></i><b>2</b> Reglas de curso y diagnostico</a>
<ul>
<li class="chapter" data-level="2.1" data-path="reglas.html"><a href="reglas.html#reglas-de-las-clases"><i class="fa fa-check"></i><b>2.1</b> Reglas de las clases</a></li>
<li class="chapter" data-level="2.2" data-path="07-rls.html"><a href="#pol%C3%ADtica-de-evaluaci%C3%B3n-y-normas-de-integridad-acad%C3%A9mica"><i class="fa fa-check"></i><b>2.2</b> Política de evaluación y normas de integridad académica</a></li>
<li class="chapter" data-level="2.3" data-path="reglas.html"><a href="reglas.html#fechas-de-taller-y-examenes"><i class="fa fa-check"></i><b>2.3</b> Fechas de taller y examenes</a></li>
<li class="chapter" data-level="2.4" data-path="07-rls.html"><a href="#programaci%C3%B3n-del-curso-por-unidad"><i class="fa fa-check"></i><b>2.4</b> Programación del curso por unidad</a></li>
<li class="chapter" data-level="2.5" data-path="reglas.html"><a href="reglas.html#referencias"><i class="fa fa-check"></i><b>2.5</b> Referencias</a></li>
<li class="chapter" data-level="2.6" data-path="07-rls.html"><a href="#terminos-b%C3%A1sicos-de-la-estad%C3%ADstica"><i class="fa fa-check"></i><b>2.6</b> Terminos básicos de la estadística</a></li>
<li class="chapter" data-level="2.7" data-path="07-rls.html"><a href="#diagnostico-de-estad%C3%ADstica-b%C3%A1sica"><i class="fa fa-check"></i><b>2.7</b> Diagnostico de estadística básica</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="eda.html"><a href="eda.html"><i class="fa fa-check"></i><b>3</b> Análisis exploratorio de datos (EDA)</a>
<ul>
<li class="chapter" data-level="3.1" data-path="07-rls.html"><a href="#cu%C3%A1ndo-debo-utilizarlo"><i class="fa fa-check"></i><b>3.1</b> ¿Cuándo debo utilizarlo?</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="07-rls.html"><a href="#tipos-de-an%C3%A1lisis-exploratorio"><i class="fa fa-check"></i><b>3.1.1</b> Tipos de análisis exploratorio:</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="07-rls.html"><a href="#representaci%C3%B3n-de-datos-seg%C3%BAn-su-naturaleza"><i class="fa fa-check"></i><b>3.2</b> Representación de datos según su naturaleza</a></li>
<li class="chapter" data-level="3.3" data-path="07-rls.html"><a href="#presentaci%C3%B3n-y-an%C3%A1lisis-de-la-informaci%C3%B3n-en-estudios-descriptivos"><i class="fa fa-check"></i><b>3.3</b> Presentación y análisis de la información en estudios descriptivos</a></li>
<li class="chapter" data-level="3.4" data-path="07-rls.html"><a href="#an%C3%A1lisis-explotario-con-variable-respuesta-num%C3%A9rica"><i class="fa fa-check"></i><b>3.4</b> Análisis explotario con variable respuesta numérica</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="eda.html"><a href="eda.html#contexto-de-los-datos-de-walmart"><i class="fa fa-check"></i><b>3.4.1</b> Contexto de los datos de Walmart</a></li>
<li class="chapter" data-level="3.4.2" data-path="07-rls.html"><a href="#extracci%C3%B3n-transformaci%C3%B3n-y-carga-etl"><i class="fa fa-check"></i><b>3.4.2</b> Extracción, transformación y carga (ETL)</a></li>
<li class="chapter" data-level="3.4.3" data-path="07-rls.html"><a href="#an%C3%A1lisis-de-la-variable-weekly_sales-target"><i class="fa fa-check"></i><b>3.4.3</b> Análisis de la variable <code>weekly_sales</code> (Target)</a></li>
<li class="chapter" data-level="3.4.4" data-path="07-rls.html"><a href="#an%C3%A1lisis-de-las-variables-caracter%C3%ADsticas-independientes"><i class="fa fa-check"></i><b>3.4.4</b> Análisis de las variables características (independientes)</a></li>
<li class="chapter" data-level="3.4.5" data-path="07-rls.html"><a href="#an%C3%A1lisis-exploratorio-bivariado"><i class="fa fa-check"></i><b>3.4.5</b> Análisis exploratorio bivariado</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="07-rls.html"><a href="#an%C3%A1lisis-explotario-con-variable-respuesta-categ%C3%B3rica"><i class="fa fa-check"></i><b>3.5</b> Análisis explotario con variable respuesta categórica</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="eda.html"><a href="eda.html#contexto-del-conjunto-de-datos-de-marketing-de-un-banco"><i class="fa fa-check"></i><b>3.5.1</b> Contexto del conjunto de datos de marketing de un banco</a></li>
<li class="chapter" data-level="3.5.2" data-path="07-rls.html"><a href="#extracci%C3%B3n-transformaci%C3%B3n-y-carga-etl-1"><i class="fa fa-check"></i><b>3.5.2</b> Extracción, transformación y carga (ETL)</a></li>
<li class="chapter" data-level="3.5.3" data-path="07-rls.html"><a href="#an%C3%A1lisis-de-la-variable-y-target"><i class="fa fa-check"></i><b>3.5.3</b> Análisis de la variable <code>y</code> (Target)</a></li>
<li class="chapter" data-level="3.5.4" data-path="07-rls.html"><a href="#an%C3%A1lisis-de-las-variables-caracter%C3%ADsticas-independientes-1"><i class="fa fa-check"></i><b>3.5.4</b> Análisis de las variables características (independientes)</a></li>
<li class="chapter" data-level="3.5.5" data-path="07-rls.html"><a href="#an%C3%A1lisis-exploratorio-bivariado-1"><i class="fa fa-check"></i><b>3.5.5</b> Análisis exploratorio bivariado</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="estparynopar.html"><a href="estparynopar.html"><i class="fa fa-check"></i><b>4</b> Análisis de estadística paramétrica y no paramétrica</a>
<ul>
<li class="chapter" data-level="4.1" data-path="07-rls.html"><a href="#comparaci%C3%B3n-de-medias-entre-dos-grupos-independientes-con-estad%C3%ADstica-param%C3%A9trica"><i class="fa fa-check"></i><b>4.1</b> Comparación de medias entre dos grupos independientes con estadística paramétrica</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="estparynopar.html"><a href="estparynopar.html#condiciones-del-t-test-para-muestras-independientes"><i class="fa fa-check"></i><b>4.1.1</b> Condiciones del t-test para muestras independientes</a></li>
<li class="chapter" data-level="4.1.2" data-path="estparynopar.html"><a href="estparynopar.html#grados-de-libertad"><i class="fa fa-check"></i><b>4.1.2</b> Grados de libertad</a></li>
<li class="chapter" data-level="4.1.3" data-path="07-rls.html"><a href="#error-est%C3%A1ndar-de-la-diferencia-de-medias"><i class="fa fa-check"></i><b>4.1.3</b> Error estándar de la diferencia de medias</a></li>
<li class="chapter" data-level="4.1.4" data-path="07-rls.html"><a href="#tama%C3%B1o-del-efecto-effect-size-en-comparaciones-de-medias"><i class="fa fa-check"></i><b>4.1.4</b> Tamaño del Efecto (Effect Size) en comparaciones de medias</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="07-rls.html"><a href="#comparaci%C3%B3n-de-medias-entre-dos-grupos-pareados-con-estad%C3%ADstica-param%C3%A9trica"><i class="fa fa-check"></i><b>4.2</b> Comparación de medias entre dos grupos pareados con estadística paramétrica</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="estparynopar.html"><a href="estparynopar.html#supuestos-del-t-test-para-muestras-dependientes"><i class="fa fa-check"></i><b>4.2.1</b> Supuestos del t-test para muestras dependientes</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="07-rls.html"><a href="#comparaci%C3%B3n-de-dos-grupos-independientes-con-estad%C3%ADstica-no-param%C3%A9trica"><i class="fa fa-check"></i><b>4.3</b> Comparación de dos grupos independientes con estadística no paramétrica</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="estparynopar.html"><a href="estparynopar.html#fundamento-conceptual"><i class="fa fa-check"></i><b>4.3.1</b> Fundamento conceptual</a></li>
<li class="chapter" data-level="4.3.2" data-path="07-rls.html"><a href="#comparaci%C3%B3n-con-el-test-t"><i class="fa fa-check"></i><b>4.3.2</b> Comparación con el test t</a></li>
<li class="chapter" data-level="4.3.3" data-path="07-rls.html"><a href="#supuestos-y-condiciones-de-aplicaci%C3%B3n"><i class="fa fa-check"></i><b>4.3.3</b> Supuestos y condiciones de aplicación</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="07-rls.html"><a href="#comparaci%C3%B3n-de-dos-grupos-pareados-con-estad%C3%ADstica-no-param%C3%A9trica"><i class="fa fa-check"></i><b>4.4</b> Comparación de dos grupos pareados con estadística no paramétrica</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="07-rls.html"><a href="#cu%C3%A1ndo-se-recomienda-utilizar-esta-prueba"><i class="fa fa-check"></i><b>4.4.1</b> ¿Cuándo se recomienda utilizar esta prueba?</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="07-rls.html"><a href="#anova-an%C3%A1lisis-de-varianza-para-comparar-m%C3%BAltiples-medias"><i class="fa fa-check"></i><b>4.5</b> ANOVA (análisis de varianza para comparar múltiples medias)</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="07-rls.html"><a href="#supuestos-y-formulaci%C3%B3n-de-las-hip%C3%B3tesis"><i class="fa fa-check"></i><b>4.5.1</b> Supuestos y formulación de las hipótesis</a></li>
<li class="chapter" data-level="4.5.2" data-path="07-rls.html"><a href="#sumas-de-cuadrados-y-teorema-de-descomposici%C3%B3n"><i class="fa fa-check"></i><b>4.5.2</b> Sumas de cuadrados y teorema de descomposición</a></li>
<li class="chapter" data-level="4.5.3" data-path="estparynopar.html"><a href="estparynopar.html#estimaciones-insesgadas-de-la-varianza-poblacional"><i class="fa fa-check"></i><b>4.5.3</b> Estimaciones insesgadas de la varianza poblacional</a></li>
<li class="chapter" data-level="4.5.4" data-path="07-rls.html"><a href="#teorema-de-contraste-para-el-an%C3%A1lisis-de-varianza"><i class="fa fa-check"></i><b>4.5.4</b> Teorema de contraste para el análisis de varianza</a></li>
<li class="chapter" data-level="4.5.5" data-path="07-rls.html"><a href="#comparaciones-m%C3%BAltiples"><i class="fa fa-check"></i><b>4.5.5</b> Comparaciones múltiples</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="estparynopar.html"><a href="estparynopar.html#kruskalwallis"><i class="fa fa-check"></i><b>4.6</b> Kruskal–Wallis</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="07-rls.html"><a href="#hip%C3%B3tesis-del-test"><i class="fa fa-check"></i><b>4.6.1</b> Hipótesis del test</a></li>
<li class="chapter" data-level="4.6.2" data-path="07-rls.html"><a href="#estad%C3%ADstico-de-prueba"><i class="fa fa-check"></i><b>4.6.2</b> Estadístico de prueba</a></li>
<li class="chapter" data-level="4.6.3" data-path="estparynopar.html"><a href="estparynopar.html#condiciones-del-test-de-kruskalwallis"><i class="fa fa-check"></i><b>4.6.3</b> Condiciones del test de Kruskal–Wallis</a></li>
<li class="chapter" data-level="4.6.4" data-path="estparynopar.html"><a href="estparynopar.html#comparaciones-post-hoc"><i class="fa fa-check"></i><b>4.6.4</b> Comparaciones Post-Hoc</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="tabcontingencia.html"><a href="tabcontingencia.html"><i class="fa fa-check"></i><b>5</b> Tabla de contingencia</a>
<ul>
<li class="chapter" data-level="5.1" data-path="07-rls.html"><a href="#tablas-de-contingencia-con-dos-criterios-de-clasificaci%C3%B3n"><i class="fa fa-check"></i><b>5.1</b> Tablas de contingencia con dos criterios de clasificación</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="tabcontingencia.html"><a href="tabcontingencia.html#prueba-de-homogeneidad"><i class="fa fa-check"></i><b>5.1.1</b> Prueba de homogeneidad</a></li>
<li class="chapter" data-level="5.1.2" data-path="tabcontingencia.html"><a href="tabcontingencia.html#prueba-de-independencia"><i class="fa fa-check"></i><b>5.1.2</b> Prueba de independencia</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="correglin.html"><a href="correglin.html"><i class="fa fa-check"></i><b>6</b> Correlación lineal</a>
<ul>
<li class="chapter" data-level="6.1" data-path="07-rls.html"><a href="#definiciones-y-teorema-de-correlaci%C3%B3n"><i class="fa fa-check"></i><b>6.1</b> Definiciones y teorema de correlación</a></li>
<li class="chapter" data-level="6.2" data-path="07-rls.html"><a href="#an%C3%A1lisis-de-correlaci%C3%B3n-simple-dos-variables"><i class="fa fa-check"></i><b>6.2</b> Análisis de correlación simple (dos variables)</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="07-rls.html"><a href="#tipos-de-coeficientes-de-correlaci%C3%B3n"><i class="fa fa-check"></i><b>6.2.1</b> Tipos de coeficientes de correlación</a></li>
<li class="chapter" data-level="6.2.2" data-path="07-rls.html"><a href="#interpretaci%C3%B3n-del-coeficiente-de-correlaci%C3%B3n"><i class="fa fa-check"></i><b>6.2.2</b> Interpretación del coeficiente de correlación</a></li>
<li class="chapter" data-level="6.2.3" data-path="07-rls.html"><a href="#correlaci%C3%B3n-de-pearson"><i class="fa fa-check"></i><b>6.2.3</b> Correlación de Pearson</a></li>
<li class="chapter" data-level="6.2.4" data-path="07-rls.html"><a href="#correlaci%C3%B3n-de-spearman"><i class="fa fa-check"></i><b>6.2.4</b> Correlación de Spearman</a></li>
<li class="chapter" data-level="6.2.5" data-path="07-rls.html"><a href="#correlaci%C3%B3n-de-kendall"><i class="fa fa-check"></i><b>6.2.5</b> Correlación de Kendall</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="rls.html"><a href="rls.html"><i class="fa fa-check"></i><b>7</b> Regresión lineal simple</a>
<ul>
<li class="chapter" data-level="7.1" data-path="07-rls.html"><a href="#el-modelo-de-regresi%C3%B3n-lineal-simple-rls"><i class="fa fa-check"></i><b>7.1</b> El modelo de regresión lineal simple (RLS)</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="07-rls.html"><a href="#modelo-determinista-y-modelo-probabil%C3%ADstico"><i class="fa fa-check"></i><b>7.1.1</b> Modelo determinista y modelo probabilístico</a></li>
<li class="chapter" data-level="7.1.2" data-path="07-rls.html"><a href="#supuestos-b%C3%A1sicos-para-el-modelo-de-regresi%C3%B3n-lineal."><i class="fa fa-check"></i><b>7.1.2</b> Supuestos básicos para el modelo de regresión lineal.</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="07-rls.html"><a href="#estimaci%C3%B3n-de-los-par%C3%A1metros-por-minimos-cuadrados-de-beta_0-beta_1"><i class="fa fa-check"></i><b>7.2</b> Estimación de los parámetros por minimos cuadrados de <span class="math inline">\(\beta_0, \beta_1\)</span></a></li>
<li class="chapter" data-level="7.3" data-path="07-rls.html"><a href="#estimaci%C3%B3n-de-sigma2"><i class="fa fa-check"></i><b>7.3</b> Estimación de <span class="math inline">\(\sigma^2\)</span></a></li>
<li class="chapter" data-level="7.4" data-path="07-rls.html"><a href="#coeficiente-de-determinaci%C3%B3n"><i class="fa fa-check"></i><b>7.4</b> Coeficiente de determinación</a></li>
<li class="chapter" data-level="7.5" data-path="07-rls.html"><a href="#propiedades-de-estimadores-de-m%C3%ADnimos-cuadrados"><i class="fa fa-check"></i><b>7.5</b> Propiedades de estimadores de mínimos cuadrados</a></li>
<li class="chapter" data-level="7.6" data-path="07-rls.html"><a href="#estimaci%C3%B3n-de-invervalos-de-confianza-y-prueba-de-hip%C3%B3tesis-para-beta_1-beta_0-y-sigma2"><i class="fa fa-check"></i><b>7.6</b> Estimación de invervalos de confianza y prueba de hipótesis para <span class="math inline">\(\beta_1, \beta_0\)</span> y <span class="math inline">\(\sigma^2\)</span></a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="rls.html"><a href="rls.html#intervalo-de-confianza-para-beta_1"><i class="fa fa-check"></i><b>7.6.1</b> Intervalo de confianza para <span class="math inline">\(\beta_1\)</span></a></li>
<li class="chapter" data-level="7.6.2" data-path="07-rls.html"><a href="#prueba-de-hip%C3%B3tesis-para-beta_1"><i class="fa fa-check"></i><b>7.6.2</b> Prueba de hipótesis para <span class="math inline">\(\beta_1\)</span></a></li>
<li class="chapter" data-level="7.6.3" data-path="rls.html"><a href="rls.html#intervalo-de-confianza-para-beta_0"><i class="fa fa-check"></i><b>7.6.3</b> Intervalo de confianza para <span class="math inline">\(\beta_0\)</span></a></li>
<li class="chapter" data-level="7.6.4" data-path="07-rls.html"><a href="#prueba-de-hip%C3%B3tesis-para-beta_0"><i class="fa fa-check"></i><b>7.6.4</b> Prueba de hipótesis para <span class="math inline">\(\beta_0\)</span></a></li>
<li class="chapter" data-level="7.6.5" data-path="rls.html"><a href="rls.html#intervalo-de-confianza-para-sigma2"><i class="fa fa-check"></i><b>7.6.5</b> Intervalo de confianza para <span class="math inline">\(\sigma^2\)</span></a></li>
<li class="chapter" data-level="7.6.6" data-path="07-rls.html"><a href="#prueba-de-hip%C3%B3tesis-para-sigma2"><i class="fa fa-check"></i><b>7.6.6</b> Prueba de hipótesis para <span class="math inline">\(\sigma^2\)</span></a></li>
<li class="chapter" data-level="7.6.7" data-path="07-rls.html"><a href="#anova-en-regresi%C3%B3n-lineal"><i class="fa fa-check"></i><b>7.6.7</b> ANOVA en regresión lineal</a></li>
<li class="chapter" data-level="7.6.8" data-path="07-rls.html"><a href="#hip%C3%B3tesis-global"><i class="fa fa-check"></i><b>7.6.8</b> Hipótesis global</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="rls.html"><a href="rls.html#transformaciones-para-mejorar-el-ajuste-del-modelo"><i class="fa fa-check"></i><b>7.7</b> Transformaciones para mejorar el ajuste del modelo</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="07-rls.html"><a href="#por-qu%C3%A9-transformar-variables"><i class="fa fa-check"></i><b>7.7.1</b> ¿Por qué transformar variables?</a></li>
<li class="chapter" data-level="7.7.2" data-path="rls.html"><a href="rls.html#tipos-comunes-de-transformaciones"><i class="fa fa-check"></i><b>7.7.2</b> Tipos comunes de transformaciones</a></li>
<li class="chapter" data-level="7.7.3" data-path="07-rls.html"><a href="#evaluaci%C3%B3n-posterior-a-la-transformaci%C3%B3n"><i class="fa fa-check"></i><b>7.7.3</b> Evaluación posterior a la transformación</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias-1.html"><a href="referencias-1.html"><i class="fa fa-check"></i>Referencias</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Publicado con bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Notas de métodos estadísticos</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="rls" class="section level1 hasAnchor" number="7">
<h1><span class="header-section-number">Capítulo 7</span> Regresión lineal simple<a href="rls.html#rls" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>En muchos procesos productivos se controlan las condiciones de operación de un sistema. Es fundamental determinar cómo una <strong>variable respuesta</strong> cambia dependiendo de dichas condiciones.</p>
<p>Por ejemplo, en un proceso de <strong>embutido de cárnicos</strong>, la <strong>cantidad de producto empacado (en gramos)</strong> puede depender de la <strong>velocidad</strong> y la <strong>temperatura</strong> de operación de una máquina.</p>
<p>En la practica, por supuesto es importante</p>
<ol style="list-style-type: decimal">
<li><strong>Entender la relación</strong> entre la cantidad de producto empacado, la velocidad y la temperatura de operación.<br />
</li>
<li><strong>Garantizar el cumplimiento</strong> de las especificaciones en la cantidad de producto empacado.<br />
</li>
<li><strong>Optmizar las condiciones de operación</strong> para reducir costos y minimizar desperdicios.</li>
</ol>
<p>El <strong>Modelo de Regresión Lineal</strong> se aplica ampliamente en ingeniería cuando se busca dar respuesta a los tres puntos anteriores.</p>
<p>En general, los modelos de regresión lineal permiten estudiar la relación entre:</p>
<ul>
<li>Una <strong>variable respuesta</strong> <span class="math inline">\(Y\)</span>.<br />
</li>
<li>Un conjunto de <strong>variables controlables</strong> del proceso, denotadas como <span class="math inline">\(X_1, X_2, \dots, X_k\)</span>.</li>
</ul>
<p>Una vez entendida esta relación, es posible <strong>predecir valores futuros</strong> de la variable respuesta a partir de valores <strong>específicos y conocidos</strong> de las variables controlables.</p>
<div class="admon-box nota">
<div class="admon-title">
<span class="icon"></span> Nota: variable controlable
</div>
<p>
<strong>Variable controlable</strong>: Son aquellas variables de proceso que pueden medirse fácilmente y mantenerse <strong>fijas</strong> durante la operación.
</p>
</div>
<p>Dependiendo del número de variables controlables, distinguimos:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Modelo de Regresión Lineal Simple (RLS):</strong><br />
Cuando se tiene <strong>una sola variable controlable</strong>, digamos <span class="math inline">\(x\)</span>.</p></li>
<li><p><strong>Modelo de Regresión Lineal Múltiple (RLM):</strong><br />
Cuando existen <strong>más de una variable controlable</strong>, digamos <span class="math inline">\(x_1, x_2, \dots, x_k\)</span>.</p>
<ul>
<li>Ejemplo en procesos de embutidos:<br />
<span class="math display">\[
x_1 = \text{velocidad}, \quad x_2 = \text{temperatura}
\]</span></li>
</ul></li>
</ol>
<div id="el-modelo-de-regresión-lineal-simple-rls" class="section level2 hasAnchor" number="7.1">
<h2><span class="header-section-number">7.1</span> El modelo de regresión lineal simple (RLS)<a href="#el-modelo-de-regresi%C3%B3n-lineal-simple-rls" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li>Consideremos un proceso donde se tienen registros de la <code>Resistencia</code>, en <code>psi</code>, y la <code>Edad</code>, en semanas, de varias soldaduras. Los datos pueden leerse en <strong>R</strong> como se muestra a continuación:</li>
</ul>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="rls.html#cb1-1" tabindex="-1"></a><span class="do">## Lectura de datos desde archivo local</span></span>
<span id="cb1-2"><a href="rls.html#cb1-2" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="st">&quot;data/data_rls.txt&quot;</span></span>
<span id="cb1-3"><a href="rls.html#cb1-3" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.table</span>(file, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-4"><a href="rls.html#cb1-4" tabindex="-1"></a></span>
<span id="cb1-5"><a href="rls.html#cb1-5" tabindex="-1"></a><span class="do">## Primeras 6 filas</span></span>
<span id="cb1-6"><a href="rls.html#cb1-6" tabindex="-1"></a><span class="fu">head</span>(df)</span></code></pre></div>
</details>
<pre><code>##   Resistencia Edad
## 1        10.9 18.7
## 2        10.6 19.1
## 3        13.4  9.3
## 4        10.7 17.5
## 5        13.0 14.6
## 6        13.1 12.8</code></pre>
<ul>
<li>Con miras explorar si existe una relación entre la <code>Resistencia</code> y la <code>Edad</code> de la soldadura, existen dos estrategias.</li>
</ul>
<div class="admon-box observacion">
<div class="admon-title">
<span class="icon"></span> observación
</div>
En RLS, es posible establecer si existe una posible relación entre <span class="math inline">\(X\)</span> y <span class="math inline">\(Y\)</span> es
<ol>
<li>
Construir un gráfico de dispersión
</li>
<li>
Calculando el coeficiente de correlación lineal muestral
</li>
</ol>
</div>
<ul>
<li>Para construir un gráfico de dispersión procedemos de la siguiente manera:</li>
</ul>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="rls.html#cb3-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb3-2"><a href="rls.html#cb3-2" tabindex="-1"></a></span>
<span id="cb3-3"><a href="rls.html#cb3-3" tabindex="-1"></a>df <span class="sc">%&gt;%</span> </span>
<span id="cb3-4"><a href="rls.html#cb3-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> Edad, <span class="at">y =</span> Resistencia)) <span class="sc">+</span> </span>
<span id="cb3-5"><a href="rls.html#cb3-5" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb3-6"><a href="rls.html#cb3-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
</details>
<p><img src="bookdown-demo_files/figure-html/dis_rls-1.png" width="672" /></p>
<ul>
<li><p>Observe que, aparentemente, cuanto mayor sea la <code>Edad</code> de la soldadura menor será su <code>Resistencia</code>. Por lo tanto, podemos decir que la relación entre <code>Edad</code> y <code>Resistencia</code> es <strong>inversamente proporcional</strong>.</p></li>
<li><p>Ahora, miremos la correlación, suponiendo que los datos tienen comportamiento</p></li>
</ul>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="rls.html#cb4-1" tabindex="-1"></a><span class="do">## coeficiente de correlación</span></span>
<span id="cb4-2"><a href="rls.html#cb4-2" tabindex="-1"></a><span class="fu">with</span>(df, <span class="fu">cor</span>(Edad, Resistencia))</span></code></pre></div>
</details>
<pre><code>## [1] -0.8827718</code></pre>
<ul>
<li>Por lo tanto, concluimos que la relación entre la <code>Edad</code> de la soldadura y su <code>Resistencia</code> es inversamente proporcional.</li>
</ul>
<div id="modelo-determinista-y-modelo-probabilístico" class="section level3 hasAnchor" number="7.1.1">
<h3><span class="header-section-number">7.1.1</span> Modelo determinista y modelo probabilístico<a href="#modelo-determinista-y-modelo-probabil%C3%ADstico" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Para el modelo determinista:</p>
<p><span class="math display">\[
y_i = \beta_0 + \beta_1 x_i,
\]</span></p>
<p>el valor observado de la <strong>Resistencia</strong> <span class="math inline">\(Y_i\)</span> es una función lineal de la <strong>Edad</strong> <span class="math inline">\(x_i\)</span>.</p>
<p>La generalización apropiada de esto a un modelo probabilístico supone que el <strong>valor esperado</strong> de la Resistencia <span class="math inline">\(Y_i\)</span> es una <strong>función lineal</strong> de la Edad <span class="math inline">\(x_i\)</span>. Si denotamos por <span class="math inline">\(E(Y_i \,|\, X = x_i)\)</span> a la esperanza de la variable aleatoria <span class="math inline">\(Y_i\)</span>, entonces bajo el supuesto de linealidad podemos escribir:</p>
<p><span class="math display">\[
E(Y_i \,|\, X = x_i) \;=\; \beta_0 + \beta_1 x_i. \tag{7.1}
\]</span></p>
<p>En la práctica, el valor observado de <span class="math inline">\(Y_i\)</span> (Resistencia medida) se desviará inevitablemente de su valor esperado debido a la variabilidad y errores de medición.</p>
<p>Si esta diferencia se representa mediante la variable aleatoria <span class="math inline">\(\varepsilon_i\)</span>, con media cero por (7.1), se puede establecer:</p>
<p><span class="math display">\[
\varepsilon_i \;=\; Y_i - E(Y_i \,|\, X = x_i) \;=\; Y_i - (\beta_0 + \beta_1 x_i),
\]</span></p>
<p>o de manera equivalente:</p>
<p><span class="math display">\[
Y_i = \beta_0 + \beta_1 x_i + \varepsilon_i. \tag{7.2}
\]</span></p>
<p>La ecuación (7.2) es la llamada <strong>recta verdadera (o poblacional) de regresión</strong>, que describe la relación entre la <strong>Resistencia (psi)</strong> y la <strong>Edad (semanas)</strong> de las soldaduras, considerando tanto la tendencia promedio como la variabilidad aleatoria.</p>
<div class="admon-box definicion">
<div class="admon-title">
<span class="icon"></span> Definición
</div>
<p>
<p>Supongamos que estamos interesados en conocer la relación entre la variable <span class="math inline">\(Y\)</span> y una independente <span class="math inline">\(X\)</span>. Si la variable <span class="math inline">\(X\)</span> toma los valores <span class="math inline">\(x_i\)</span>, entonces la ecuación de la <strong>recta poblacional de regresión</strong> expresa los correspondientes valores de <span class="math inline">\(Y_i\)</span> como:</p>
<p><span class="math display">\[
Y_i = \beta_0 + \beta_1 x_i + \varepsilon_i,
\]</span></p>
donde <span class="math inline">\(\beta_0\)</span> y <span class="math inline">\(\beta_1\)</span> son constantes, y <span class="math inline">\(\varepsilon_i\)</span>, llamado <strong>término de error</strong>, es una variable aleatoria con media cero.
</p>
</div>
</div>
<div id="supuestos-básicos-para-el-modelo-de-regresión-lineal." class="section level3 hasAnchor" number="7.1.2">
<h3><span class="header-section-number">7.1.2</span> Supuestos básicos para el modelo de regresión lineal.<a href="#supuestos-b%C3%A1sicos-para-el-modelo-de-regresi%C3%B3n-lineal." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Los supuestos para el modelo de regresión lineal son</p>
<div class="admon-box advertencia">
<div class="admon-title">
<span class="icon"></span> Supuestos para el modelo de regresión lineal simple
</div>
<p>
Denotemos la recta verdadera de regresión por
<span class="math inline">\(Y_i = \beta_0 + \beta_1 x_i + \varepsilon_i\)</span> y asumamos que se dispone de
<span class="math inline">\(n\)</span> pares de observaciones. Suelen realizarse, al respecto, los siguientes supuestos:
</p>
<ol>
<li>
Cada <span class="math inline">\(x_i\)</span> es un número fijo (asignado, por ejemplo, por un investigador)
o es la realización de una variable aleatoria <span class="math inline">\(X_i\)</span> independiente del término de error
<span class="math inline">\(\varepsilon_i\)</span>. En el último caso, la inferencia se realiza condicionando al valor observado <span class="math inline">\(x_i\)</span>.
</li>
<li>
Los términos de error <span class="math inline">\(\varepsilon_i\)</span> son variables aleatorias con media 0,
es decir, <span class="math inline">\(E(\varepsilon_i) = 0\)</span>, para todo <span class="math inline">\(i = 1, \ldots, n\)</span>.
</li>
<li>
Las variables aleatorias <span class="math inline">\(\varepsilon_i\)</span> tienen todas la misma varianza <span class="math inline">\(\sigma^2\)</span>,
es decir, <span class="math inline">\(V(\varepsilon_i) = \sigma^2\)</span>, para todo <span class="math inline">\(i = 1, \ldots, n\)</span>.
</li>
<li>
Las variables aleatorias <span class="math inline">\(\varepsilon_i\)</span> no se hallan correlacionadas, es decir, son independientes,
luego <span class="math inline">\(E(\varepsilon_i \varepsilon_j) = 0\)</span>, para todo <span class="math inline">\(i, j = 1, \ldots, n\)</span>, con <span class="math inline">\(i \neq j\)</span>.
</li>
<li>
Los errores <span class="math inline">\(\varepsilon_i\)</span> estan distribuidos normalmente.
</li>
</ol>
</div>
<div class="admon-box teorema">
<div class="admon-title">
<span class="icon"></span> Teorema
</div>
<p>
Denotando la recta verdadera de regresión por
<span class="math inline">\(Y_i = \beta_0 + \beta_1 x_i + \varepsilon_i\)</span>,
si se cumplen los supuestos del modelo de regresión, entonces, para un valor fijo <span class="math inline">\(x_i\)</span> de <span class="math inline">\(X\)</span>,
la esperanza y varianza condicionales de <span class="math inline">\(Y_i\)</span>, dado que <span class="math inline">\(X = x_i\)</span>, vienen dadas, respectivamente, por:
</p>
<p style="text-align:center;">
<span class="math inline">\(E(Y_i \,|\, X = x_i) = \beta_0 + \beta_1 x_i \quad \text{y} \quad V(Y_i \,|\, X = x_i) = \sigma^2.\)</span>
</p>
</div>
<p style="text-align: left;">
<strong>Demostración del teorema</strong>
</p>
<ol>
<li>
<strong>Esperanza condicional.</strong><br/>
Usando linealidad de la esperanza y que <span class="math inline">\(\beta_0\)</span> y <span class="math inline">\(\beta_1\, x_i\)</span> son constantes dado <span class="math inline">\(X=x_i\)</span>:
<span class="math display">\[
      E(Y_i \mid X=x_i)
      = E(\beta_0 + \beta_1 x_i + \varepsilon_i \mid X=x_i)
      = \beta_0 + \beta_1 x_i + E(\varepsilon_i \mid X=x_i).
      \]</span>
Por independencia (o, en su defecto, por el supuesto <span class="math inline">\(E(\varepsilon_i\mid X)=0\)</span>):
<span class="math display">\[
      E(\varepsilon_i \mid X=x_i)=0.
      \]</span>
Luego,
<span class="math display">\[
      \boxed{\,E(Y_i \mid X=x_i)=\beta_0+\beta_1 x_i\,}.
      \]</span>
</li>
<li>
<p><strong>Varianza condicional.</strong><br/>
La varianza de una constante es cero y <span class="math inline">\(\beta_0+\beta_1 x_i\)</span> es constante dado <span class="math inline">\(X=x_i\)</span>:</p>
<p><span class="math display">\[\begin{align}
\operatorname{Var}(Y_i \mid X=x_i)
  &amp;= \operatorname{Var}(\beta_0 + \beta_1 x_i + \varepsilon_i \mid X=x_i) \\[6pt]
  &amp;= \operatorname{Var}(\beta_0 + \beta_1 x_i \mid X=x_i)
     + \operatorname{Var}(\varepsilon_i \mid X=x_i) \\[6pt]
  &amp;= 0 + \operatorname{Var}(\varepsilon_i \mid X=x_i).
\end{align}\]</span></p>
Por independencia (o por homocedasticidad condicional):
<span class="math display">\[
      \operatorname{Var}(\varepsilon_i \mid X=x_i) = \operatorname{Var}(\varepsilon_i)=\sigma^2.
      \]</span>
Por tanto,
<span class="math display">\[
      \boxed{\,\operatorname{Var}(Y_i \mid X=x_i)=\sigma^2\,}.
      \]</span>
</li>
</ol>
<p>En general, el modelo de RLS surge ante la necesidad de predecir una variable respuesta <span class="math inline">\(Y\)</span>, generalmente continua, como función de una variable controlable <span class="math inline">\(X\)</span>, donde matematicamente el modelo puede expresarse como:</p>
<p><span class="math display">\[
Y_i = \beta_0 + \beta_1 X_i + \varepsilon_i,
\]</span>
<span class="math display">\[
\varepsilon_i \sim \mathcal{N}(0,\sigma^2),
\]</span>
<span class="math display">\[
\sigma^2 = \text{constante}.
\]</span></p>
<p>donde <span class="math inline">\((\beta_0, \beta_1, \sigma^2)\)</span> corresponden a los <strong>parámetros del modelo</strong> y <span class="math inline">\(\varepsilon_i\)</span> es el error aleatorio para la observación <span class="math inline">\(i\)</span>.</p>
<ul>
<li>Los términos <span class="math inline">\((\beta_0, \beta_1)\)</span> se conocen como los <strong>coeficientes del modelo</strong>.<br />
</li>
<li><span class="math inline">\(\sigma^2\)</span> corresponde a la <strong>varianza</strong> de los errores.</li>
</ul>
<p>En la práctica, se tiene o se toma una <strong>muestra aleatoria de tamaño <span class="math inline">\(n\)</span></strong> proveniente de una población o de un proceso de producción/servicios.<br />
A partir de dicha muestra, se busca estimar los valores de <span class="math inline">\((\beta_0, \beta_1, \sigma^2)\)</span>.</p>
</div>
</div>
<div id="estimación-de-los-parámetros-por-minimos-cuadrados-de-beta_0-beta_1" class="section level2 hasAnchor" number="7.2">
<h2><span class="header-section-number">7.2</span> Estimación de los parámetros por minimos cuadrados de <span class="math inline">\(\beta_0, \beta_1\)</span><a href="#estimaci%C3%B3n-de-los-par%C3%A1metros-por-minimos-cuadrados-de-beta_0-beta_1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Para estimar <span class="math inline">\(\beta_0\)</span> y <span class="math inline">\(\beta_1\)</span> se usa el <strong>método de mínimos cuadrados</strong>. Esto es, se estiman <span class="math inline">\(\beta_0\)</span> y <span class="math inline">\(\beta_1\)</span> tales que la suma de los cuadrados de las diferencias entre las observaciones <span class="math inline">\(y_i\)</span> y la línea recta sea mínima.</p>
<p>El modelo es:</p>
<p><span class="math display">\[
y_i = \beta_0 + \beta_1 x_i + \varepsilon_i, \quad i=1,2,\ldots,n
\]</span></p>
<p>El criterio de mínimos cuadrados es:</p>
<p><span class="math display">\[
S(\beta_0,\beta_1) = \sum_{i=1}^n \varepsilon_i^2=\sum_{i=1}^n (y_i - \beta_0 - \beta_1 x_i)^2
\]</span></p>
<p>Para obtener los estimadores, derivamos respecto a <span class="math inline">\(\beta_0\)</span> y <span class="math inline">\(\beta_1\)</span>:</p>
<p><span class="math display">\[\begin{align}
\frac{\partial S}{\partial \beta_0}\Big|_{\hat{\beta}_0,\hat{\beta}_1}
&amp;= -2 \sum_{i=1}^n (y_i - \hat{\beta}_0 - \hat{\beta}_1 x_i) = 0 \\[6pt]
\frac{\partial S}{\partial \beta_1}\Big|_{\hat{\beta}_0,\hat{\beta}_1}
&amp;= -2 \sum_{i=1}^n (y_i - \hat{\beta}_0 - \hat{\beta}_1 x_i)x_i = 0
\end{align}\]</span></p>
<p>Estas se simplifican a las llamadas <strong>ecuaciones normales</strong>:</p>
<p><span class="math display">\[\begin{align}
n\hat{\beta}_0 + \hat{\beta}_1 \sum_{i=1}^n x_i &amp;= \sum_{i=1}^n y_i \\[6pt]
\hat{\beta}_0 \sum_{i=1}^n x_i + \hat{\beta}_1 \sum_{i=1}^n x_i^2 &amp;= \sum_{i=1}^n y_i x_i
\end{align}\]</span></p>
<p>La solución de este sistema es:</p>
<p><span class="math display">\[
\hat{\beta}_0 = \bar{y} - \hat{\beta}_1 \bar{x}
\]</span></p>
<p><span class="math display">\[
\hat{\beta}_1 = \frac{\sum_{i=1}^n y_i x_i - \frac{1}{n}\left(\sum_{i=1}^n y_i\right)\left(\sum_{i=1}^n x_i\right)}
{\sum_{i=1}^n x_i^2 - \frac{1}{n}\left(\sum_{i=1}^n x_i\right)^2}
\]</span></p>
<p>donde:</p>
<p><span class="math display">\[
\bar{y} = \frac{1}{n}\sum_{i=1}^n y_i,
\qquad
\bar{x} = \frac{1}{n}\sum_{i=1}^n x_i
\]</span></p>
<p>El modelo ajustado es:</p>
<p><span class="math display">\[
\hat{y} = \hat{\beta}_0 + \hat{\beta}_1 x
\]</span></p>
<p>De manera más sencilla, definimos:</p>
<p><span class="math display">\[
S_{xx} = \sum_{i=1}^n (x_i - \bar{x})^2
\qquad \text{y} \qquad
S_{xy} = \sum_{i=1}^n (x_i - \bar{x})(y_i - \bar{y})
\]</span></p>
<p>Entonces, una forma conveniente de escribir la pendiente es:</p>
<p><span class="math display">\[
\hat{\beta}_1 = \frac{S_{xy}}{S_{xx}}
\]</span></p>
<div class="admon-box ejercicio">
<div class="admon-title">
<span class="icon"></span> Ejercicio
</div>
<p>
Queda de ejercicio verificar que en dicho punto crítico se alcanza un mínimo local. Sugerencia, realizar la segundas derivadas parciales.
</p>
</div>
<div class="admon-box ejercicio">
<div class="admon-title">
<span class="icon"></span> Ejercicio
</div>
<p>
<ol>
<li>
Demuestre que
<span class="math display">\[\sum_{i=1}^n (x_i - \overline{x})(y_i - \overline{y}) = \sum_{i=1}^n x_i y_i - n \, \overline{x} \, \overline{y}\]</span>
</li>
<li>
Demuestre que
<span class="math display">\[\sum_{i=1}^n (x_i - \overline{x})^2 = \sum_{i=1}^n x_i^2 - n \overline{x}^2\]</span>
</li>
</ol>
</p>
</div>
<div class="admon-box observacion">
<div class="admon-title">
<span class="icon"></span> Observacion
</div>
<p>
En la práctica, <span class="math inline">\(\hat{\beta}_1\)</span> se interpreta como <strong>el cambio unitario</strong> en el valor esperado de <span class="math inline">\(Y\)</span>, es decir, en <span class="math inline">\(E[Y\mid X]\)</span>, por cada cambio unitario del <strong>factor controlable</strong> <span class="math inline">\(X\)</span>.
</p>
</div>
<ul>
<li>Continuando con el ejemplo de los datos de soldadura, estimemos paso a paso <span class="math inline">\(\beta_0, \beta_1\)</span>:</li>
</ul>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="rls.html#cb6-1" tabindex="-1"></a><span class="co"># 1. Lectura de datos</span></span>
<span id="cb6-2"><a href="rls.html#cb6-2" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.table</span>(file, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-3"><a href="rls.html#cb6-3" tabindex="-1"></a></span>
<span id="cb6-4"><a href="rls.html#cb6-4" tabindex="-1"></a><span class="co"># 2. Variables</span></span>
<span id="cb6-5"><a href="rls.html#cb6-5" tabindex="-1"></a>Y <span class="ot">&lt;-</span> df<span class="sc">$</span>Resistencia</span>
<span id="cb6-6"><a href="rls.html#cb6-6" tabindex="-1"></a>X <span class="ot">&lt;-</span> df<span class="sc">$</span>Edad</span>
<span id="cb6-7"><a href="rls.html#cb6-7" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(X)</span>
<span id="cb6-8"><a href="rls.html#cb6-8" tabindex="-1"></a></span>
<span id="cb6-9"><a href="rls.html#cb6-9" tabindex="-1"></a><span class="co"># 3. Medias</span></span>
<span id="cb6-10"><a href="rls.html#cb6-10" tabindex="-1"></a>x_bar <span class="ot">&lt;-</span> <span class="fu">mean</span>(X)</span>
<span id="cb6-11"><a href="rls.html#cb6-11" tabindex="-1"></a>y_bar <span class="ot">&lt;-</span> <span class="fu">mean</span>(Y)</span>
<span id="cb6-12"><a href="rls.html#cb6-12" tabindex="-1"></a></span>
<span id="cb6-13"><a href="rls.html#cb6-13" tabindex="-1"></a><span class="co"># 4. Cálculo de Sxx y Sxy</span></span>
<span id="cb6-14"><a href="rls.html#cb6-14" tabindex="-1"></a>Sxx <span class="ot">&lt;-</span> <span class="fu">sum</span>((X <span class="sc">-</span> x_bar)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb6-15"><a href="rls.html#cb6-15" tabindex="-1"></a>Sxy <span class="ot">&lt;-</span> <span class="fu">sum</span>((X <span class="sc">-</span> x_bar) <span class="sc">*</span> (Y <span class="sc">-</span> y_bar))</span>
<span id="cb6-16"><a href="rls.html#cb6-16" tabindex="-1"></a></span>
<span id="cb6-17"><a href="rls.html#cb6-17" tabindex="-1"></a><span class="co"># 5. Estimadores de mínimos cuadrados</span></span>
<span id="cb6-18"><a href="rls.html#cb6-18" tabindex="-1"></a>beta1 <span class="ot">&lt;-</span> Sxy <span class="sc">/</span> Sxx</span>
<span id="cb6-19"><a href="rls.html#cb6-19" tabindex="-1"></a>beta1</span></code></pre></div>
</details>
<pre><code>## [1] -0.2437636</code></pre>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="rls.html#cb8-1" tabindex="-1"></a>beta0 <span class="ot">&lt;-</span> y_bar <span class="sc">-</span> beta1 <span class="sc">*</span> x_bar</span>
<span id="cb8-2"><a href="rls.html#cb8-2" tabindex="-1"></a>beta0</span></code></pre></div>
</details>
<pre><code>## [1] 15.74275</code></pre>
<p>En <strong>R</strong> la función clave paara ajustar modelos de RLS es <code>lm</code>. Para mayor información, puede consultar la ayuda de la función escribiendo <code>?lm</code> en la consola, o en la <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/lm.html">página oficial</a>.</p>
<p>En general, la sintaxis es</p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="rls.html#cb10-1" tabindex="-1"></a><span class="co"># ajuste del modelo de RLS</span></span>
<span id="cb10-2"><a href="rls.html#cb10-2" tabindex="-1"></a>modelo <span class="ot">&lt;-</span> <span class="fu">lm</span>(Resistencia <span class="sc">~</span> Edad, <span class="at">data =</span> df)</span>
<span id="cb10-3"><a href="rls.html#cb10-3" tabindex="-1"></a>modelo</span></code></pre></div>
</details>
<pre><code>## 
## Call:
## lm(formula = Resistencia ~ Edad, data = df)
## 
## Coefficients:
## (Intercept)         Edad  
##     15.7427      -0.2438</code></pre>
<p>Los resultados indican que <span class="math inline">\(\hat{\beta}_0 = 15.74\)</span> y <span class="math inline">\(\hat{\beta}_1 = -0.244\)</span>. Por lo tanto, el modelo ajustado puede escribirse como:</p>
<p><span class="math display">\[
\widehat{\text{Resistencia}}_i = 15.74 \;-\; 0.244 \,\text{Edad}_i,
\]</span></p>
<p><span class="math display">\[
\varepsilon_i \sim N(0, \sigma^2),
\qquad
\sigma^2 = \text{constante}.
\]</span></p>
<div class="admon-box nota">
<div class="admon-title">
<span class="icon"></span> Interpretación de <span class="math inline">\(\,\hat{\beta}_0\,\)</span> y <span class="math inline">\(\,\hat{\beta}_1\)</span>
</div>
<ol>
<li>
Se espera que, por cada semana que transcurre, la <strong>resistencia de la soldadura</strong> disminuya <strong>0.244 psi</strong>. Es decir, <span class="math inline">\(\hat{\beta}_1 = -0.244\)</span>.
</li>
<li>
Una soldadura <strong>nueva</strong> <span class="math inline">\((\text{Edad} = 0)\)</span> tiene una resistencia promedio de <strong>15.74 psi</strong>. Es decir, <span class="math inline">\(\hat{\beta}_0 = 15.74\)</span>.
</li>
</ol>
</div>
<div class="admon-box ejercicio">
<div class="admon-title">
<span class="icon"></span> Ejercicio 1
</div>
<p>
Las cantidades de un compuesto químico “y”, que se disuelven en 100 gramos de agua a varias temperaturas “x”, se registran como sigue:
</p>
<table>
<thead>
<tr>
<th>
x (°C)
</th>
<th>
y (gramos)
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
0
</td>
<td>
8
</td>
</tr>
<tr>
<td>
0
</td>
<td>
6
</td>
</tr>
<tr>
<td>
0
</td>
<td>
8
</td>
</tr>
<tr>
<td>
15
</td>
<td>
12
</td>
</tr>
<tr>
<td>
15
</td>
<td>
10
</td>
</tr>
<tr>
<td>
15
</td>
<td>
14
</td>
</tr>
<tr>
<td>
30
</td>
<td>
25
</td>
</tr>
<tr>
<td>
30
</td>
<td>
21
</td>
</tr>
<tr>
<td>
30
</td>
<td>
24
</td>
</tr>
<tr>
<td>
45
</td>
<td>
31
</td>
</tr>
<tr>
<td>
45
</td>
<td>
33
</td>
</tr>
<tr>
<td>
45
</td>
<td>
28
</td>
</tr>
<tr>
<td>
60
</td>
<td>
44
</td>
</tr>
<tr>
<td>
60
</td>
<td>
39
</td>
</tr>
<tr>
<td>
60
</td>
<td>
42
</td>
</tr>
<tr>
<td>
75
</td>
<td>
48
</td>
</tr>
<tr>
<td>
75
</td>
<td>
51
</td>
</tr>
<tr>
<td>
75
</td>
<td>
44
</td>
</tr>
</tbody>
</table>
<ol type="a">
<li>
Grafique un diagrama de dispersión de los datos. ¿Parecerá plausible un modelo de regresión lineal simple?
</li>
<li>
Encuentre las estimaciones de mínimos cuadrados de la pendiente y la ordenada al origen del modelo de regresión lineal simple.
</li>
<li>
Estime la cantidad de compuesto químico que se disolverá en 100 gramos de agua a 50°C.
</li>
</ol>
</div>
</div>
<div id="estimación-de-sigma2" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Estimación de <span class="math inline">\(\sigma^2\)</span><a href="#estimaci%C3%B3n-de-sigma2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Además de estimar <span class="math inline">\(\beta_0\)</span> y <span class="math inline">\(\beta_1\)</span>, se requiere un estimado de <span class="math inline">\(\sigma^2\)</span> para probar hipótesis y formar intervalos de confianza pertinentes al modelo de regresión.</p>
<p>Ahora, se llama <strong>residuos</strong> (errores) a las desviaciones verticales</p>
<p><span class="math display">\[\varepsilon_i = y_i - \hat{y}_i, \quad i = 1, 2, \ldots, n\]</span></p>
<p>de la recta estimada.</p>
<p>Cuando no se puede usar información previa, el estimado de <span class="math inline">\(\sigma^2\)</span> se obtiene de la <strong>suma de cuadrados de los errores (SSE)</strong>:</p>
<p><span class="math display">\[
SSE = S = \sum_{i=1}^n \varepsilon_i^2 = \sum_{i=1}^n (y_i - \hat{y}_i)^2 \tag{7.3}
\]</span></p>
<p>Si sustituimos <span class="math inline">\(\hat{y}_i = \hat{\beta_0}+\hat{\beta_1}x_i\)</span> en la ecuación (7.3) tenemos que</p>
<p><span class="math display">\[\begin{align}
SSE &amp;= \sum_{i=1}^n (y_i - \hat{y}_i)^2 \\[6pt]
&amp;= \sum_{i=1}^n \left( y_i - \hat{\beta}_0 - \hat{\beta}_1 x_i \right)^2 \\[6pt]
&amp;= \sum_{i=1}^n \left( y_i - \bar{y} + \hat{\beta}_1 \bar{x} - \hat{\beta}_1 x_i \right)^2 \\[6pt]
&amp;= \sum_{i=1}^n \left[ (y_i - \bar{y}) - \hat{\beta}_1 (x_i - \bar{x}) \right]^2 \\[6pt]
&amp;= \sum_{i=1}^n (y_i - \bar{y})^2
   - 2\hat{\beta}_1 \sum_{i=1}^n (y_i - \bar{y})(x_i - \bar{x})
   + \hat{\beta}_1^2 \sum_{i=1}^n (x_i - \bar{x})^2 \\[6pt]
&amp;= SST - 2\hat{\beta}_1 S_{xy} + \hat{\beta}_1^2 S_{xx}
\end{align}\]</span></p>
<p>Como <span class="math inline">\(\hat{\beta_1}=\frac{S_{xy}}{S_{xx}}\)</span> se sigue que</p>
<p><span class="math display">\[\begin{align}
SSE &amp;= SST - 2\hat{\beta}_1 S_{xy} + \hat{\beta}_1^2 S_{xx} \\[6pt]
&amp;= SST - 2\hat{\beta}_1 S_{xy} + \hat{\beta}_1 \left(\frac{S_{xy}}{S_{xx}}\right) S_{xx} \\[6pt]
&amp;= SST - 2\hat{\beta}_1 S_{xy} + \hat{\beta}_1 S_{xy} \\[6pt]
&amp;= SST - \hat{\beta}_1 S_{xy},
\end{align}\]</span></p>
<p>donde</p>
<p><span class="math display">\[\begin{align}
SST &amp;= \sum_{i=1}^n \left(y_i - \bar{y}\right)^2, \\[6pt]
SSE &amp;= \sum_{i=1}^n \left(y_i - \hat{y}_i\right)^2.
\end{align}\]</span></p>
<p>La suma de cuadrados de residuales tiene <span class="math inline">\(n - 2\)</span> grados de libertad, porque dos grados de libertad se asocian con los estimados <span class="math inline">\(\hat{\beta}_0\)</span> y <span class="math inline">\(\hat{\beta}_1\)</span> que se usan para obtener <span class="math inline">\(\hat{y}_i\)</span>.</p>
<p>Por el teorema de MSA y MSE insesgado de <span class="math inline">\(\sigma^2\)</span>, sabemos que el valor esperado de <span class="math inline">\(SSE\)</span> es:</p>
<p><span class="math display">\[
E(SSE) = (n-2)\sigma^2,
\]</span></p>
<p>por lo que un <strong>estimador insesgado</strong> de <span class="math inline">\(\sigma^2\)</span> es:</p>
<p><span class="math display">\[
\hat{\sigma}^2 = \frac{SSE}{n-2} = MSE
\]</span></p>
<p>La cantidad <span class="math inline">\(MSE\)</span> se llama <strong>cuadrado medio residual</strong>. La raíz cuadrada de <span class="math inline">\(\hat{\sigma}^2\)</span> se llama, a veces, el <strong>error estándar de la regresión (RSE)</strong>, y tiene las mismas unidades que la variable respuesta <span class="math inline">\(y\)</span>.</p>
<p>Ya que <span class="math inline">\(\hat{\sigma}^2\)</span> depende de la suma de cuadrados de residuales, cualquier violación de las hipótesis sobre los errores del modelo, o cualquier especificación equivocada de la forma del modelo, pueden dañar la utilidad de <span class="math inline">\(\hat{\sigma}^2\)</span> como estimador de <span class="math inline">\(\sigma^2\)</span>.</p>
<p>Como <span class="math inline">\(\sigma^2\)</span> se calcula con los residuales del modelo de regresión, se dice que es un <strong>estimador de <span class="math inline">\(\sigma^2\)</span> dependiente del modelo</strong>.</p>
<p>Finalmente, el modelo de <strong>Regresión Lineal Simple (RLS)</strong> estimado es</p>
<p><span class="math display">\[\begin{align}
\hat{Y}_i &amp;= \hat{\beta}_0 + \hat{\beta}_1 X_i, \\[6pt]
\varepsilon_i &amp;\sim N(0, \hat{\sigma}^2), \\[6pt]
\hat{\sigma}^2 &amp;= \text{constante}.
\end{align}\]</span></p>
<p>Otra forma de expresarlo es</p>
<p><span class="math display">\[\begin{align}
\hat{Y}_i &amp;\sim N(\hat{\mu}_i, \hat{\sigma}^2), \\[6pt]
\hat{\mu}_i &amp;= \hat{\beta}_0 + \hat{\beta}_1 X_i.
\end{align}\]</span></p>
<ul>
<li>A partir del modelo ajustado es posible <strong>predecir el valor esperado de <span class="math inline">\(Y\)</span></strong> para valores conocidos de <span class="math inline">\(X\)</span>, es decir, si fijamos un valor <span class="math inline">\(x_0\)</span> del factor <span class="math inline">\(X\)</span>, podemos calcular:</li>
</ul>
<p><span class="math display">\[
E[Y \mid X = x_0].
\]</span></p>
<ul>
<li>Continuando con el ejemplo de soldaduras. Estimemos el <span class="math inline">\(\sigma\)</span>. Haciendolo paso a paso</li>
</ul>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="rls.html#cb12-1" tabindex="-1"></a><span class="co"># 1. Cargar datos</span></span>
<span id="cb12-2"><a href="rls.html#cb12-2" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">&quot;data/data_rls.txt&quot;</span>, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-3"><a href="rls.html#cb12-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> datos<span class="sc">$</span>Edad</span>
<span id="cb12-4"><a href="rls.html#cb12-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> datos<span class="sc">$</span>Resistencia</span>
<span id="cb12-5"><a href="rls.html#cb12-5" tabindex="-1"></a></span>
<span id="cb12-6"><a href="rls.html#cb12-6" tabindex="-1"></a><span class="co"># 2. Ajustar el modelo de regresión lineal simple</span></span>
<span id="cb12-7"><a href="rls.html#cb12-7" tabindex="-1"></a>modelo <span class="ot">&lt;-</span> <span class="fu">lm</span>(Resistencia <span class="sc">~</span> Edad, <span class="at">data =</span> datos)</span>
<span id="cb12-8"><a href="rls.html#cb12-8" tabindex="-1"></a></span>
<span id="cb12-9"><a href="rls.html#cb12-9" tabindex="-1"></a><span class="co"># 3. Los coeficientes son</span></span>
<span id="cb12-10"><a href="rls.html#cb12-10" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> modelo<span class="sc">$</span>coefficients[<span class="dv">1</span>]</span>
<span id="cb12-11"><a href="rls.html#cb12-11" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> modelo<span class="sc">$</span>coefficients[<span class="dv">2</span>]</span>
<span id="cb12-12"><a href="rls.html#cb12-12" tabindex="-1"></a></span>
<span id="cb12-13"><a href="rls.html#cb12-13" tabindex="-1"></a><span class="co"># 4. Ajustados y residuos</span></span>
<span id="cb12-14"><a href="rls.html#cb12-14" tabindex="-1"></a>yhat <span class="ot">&lt;-</span> b0 <span class="sc">+</span> b1 <span class="sc">*</span> x</span>
<span id="cb12-15"><a href="rls.html#cb12-15" tabindex="-1"></a>e    <span class="ot">&lt;-</span> y <span class="sc">-</span> yhat</span>
<span id="cb12-16"><a href="rls.html#cb12-16" tabindex="-1"></a></span>
<span id="cb12-17"><a href="rls.html#cb12-17" tabindex="-1"></a><span class="co"># 5. SSE por definición</span></span>
<span id="cb12-18"><a href="rls.html#cb12-18" tabindex="-1"></a>SSE <span class="ot">&lt;-</span> <span class="fu">sum</span>(e<span class="sc">^</span><span class="dv">2</span>) </span>
<span id="cb12-19"><a href="rls.html#cb12-19" tabindex="-1"></a></span>
<span id="cb12-20"><a href="rls.html#cb12-20" tabindex="-1"></a><span class="co"># Otra forma de btener los residuos</span></span>
<span id="cb12-21"><a href="rls.html#cb12-21" tabindex="-1"></a>residuos <span class="ot">&lt;-</span> <span class="fu">resid</span>(modelo)</span>
<span id="cb12-22"><a href="rls.html#cb12-22" tabindex="-1"></a>SSE_otro <span class="ot">&lt;-</span> <span class="fu">sum</span>(residuos<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb12-23"><a href="rls.html#cb12-23" tabindex="-1"></a></span>
<span id="cb12-24"><a href="rls.html#cb12-24" tabindex="-1"></a><span class="co"># 6. Calcular MSE</span></span>
<span id="cb12-25"><a href="rls.html#cb12-25" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(datos)              <span class="co"># número de observaciones</span></span>
<span id="cb12-26"><a href="rls.html#cb12-26" tabindex="-1"></a>gl <span class="ot">&lt;-</span> n <span class="sc">-</span> <span class="dv">2</span>                   <span class="co"># grados de libertad</span></span>
<span id="cb12-27"><a href="rls.html#cb12-27" tabindex="-1"></a>MSE <span class="ot">&lt;-</span> SSE <span class="sc">/</span> gl</span>
<span id="cb12-28"><a href="rls.html#cb12-28" tabindex="-1"></a>MSE</span></code></pre></div>
</details>
<pre><code>## [1] 0.3491253</code></pre>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="rls.html#cb14-1" tabindex="-1"></a><span class="co"># 7. Calcular RSE</span></span>
<span id="cb14-2"><a href="rls.html#cb14-2" tabindex="-1"></a>RSE <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(MSE)</span>
<span id="cb14-3"><a href="rls.html#cb14-3" tabindex="-1"></a>RSE</span></code></pre></div>
</details>
<pre><code>## [1] 0.5908683</code></pre>
<p>Cuando ajustamos el modelo con la función <code>modelo &lt;- lm(Resistencia ~ Edad, data = datos)</code> para obtener el RSE de la siguiente forma</p>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="rls.html#cb16-1" tabindex="-1"></a><span class="do">## estimación de sigma</span></span>
<span id="cb16-2"><a href="rls.html#cb16-2" tabindex="-1"></a><span class="fu">summary</span>(modelo)<span class="sc">$</span>sigma</span></code></pre></div>
</details>
<pre><code>## [1] 0.5908683</code></pre>
<p>A partir de este resultado podemos concluir que <span class="math inline">\(\hat{\sigma}=0.591\)</span>. Por lo tanto, <span class="math inline">\(MSE=0.591^2=0.349\)</span>. Finalmente, el modelo ajustado puede expresarse como</p>
<p><span class="math display">\[\begin{align}
\widehat{\text{Resistencia}}_i &amp;\sim N(\hat{\mu}_i, \hat{\sigma}^2) \\[6pt]
\hat{\mu}_i &amp;= 15.743 - 0.244 \, \text{Edad}_i \\[6pt]
\hat{\sigma}^2 &amp;= 0.591^2 = 0.349
\end{align}\]</span></p>
</div>
<div id="coeficiente-de-determinación" class="section level2 hasAnchor" number="7.4">
<h2><span class="header-section-number">7.4</span> Coeficiente de determinación<a href="#coeficiente-de-determinaci%C3%B3n" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="admon-box definicion">
<div class="admon-title">
<span class="icon"></span> Definición: coeficiente de determinación
</div>
<p>
El <strong>Coeficiente de Determinación (<span class="math inline">\(R^2\)</span>)</strong> es una medida estadística que indica la
proporción de la variabilidad total de la variable dependiente <span class="math inline">\(Y\)</span> que es explicada por el modelo
de regresión.
</p>
<p>
Se define como:
<br>
<span class="math display">\[ R^2 =  1 - \dfrac{SSE}{SST} \]</span>
</p>
<p>
Su valor está comprendido entre 0 y 1:
<ul>
<li>
<span class="math inline">\(R^2 \approx 1\)</span>: el modelo explica gran parte de la variabilidad de los datos.
</li>
<li>
<span class="math inline">\(R^2 \approx 0\)</span>: el modelo explica muy poca variabilidad.
</li>
</ul>
</p>
</div>
<p>El coeficiente de determinación puede escribirse de un modo diferente al introducir una tercera suma de cuadrados,
la <strong>suma de cuadrados de regresión</strong>.</p>
<p><span class="math display">\[\begin{align}
SSR &amp;= \sum_{i=1}^{n} (\hat{y}_i - \bar{y})^2 = \sum (\hat{y}_i - \bar{y})^2 = \sum \left( \hat{\beta}_0 + \hat{\beta}_1 x_i - \bar{y} \right)^2 \\[6pt]
    &amp;= \sum \left( -\hat{\beta}_1 \bar{x} + \hat{\beta}_1 x_i \right)^2 = \hat{\beta}_1^2 \sum (x_i - \bar{x})^2 = \hat{\beta}_1 S_{xy} = SST - SSE
\end{align}\]</span></p>
<p>Así,</p>
<p><span class="math display">\[\begin{align}
R^2 = 1 - \frac{SSE}{SST} = \frac{SST - SSE}{SST} = \frac{SSR}{SST} = \frac{\hat{\beta}_1 S_{xy}}{S_{yy}}
\end{align}\]</span></p>
<ul>
<li>Continuando con el ejemplo de los datos de soldadura, calculemos paso a paso el coeficiente de determinación</li>
</ul>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="rls.html#cb18-1" tabindex="-1"></a><span class="co"># 1. Lectura de datos</span></span>
<span id="cb18-2"><a href="rls.html#cb18-2" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="st">&quot;data/data_rls.txt&quot;</span></span>
<span id="cb18-3"><a href="rls.html#cb18-3" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.table</span>(file, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb18-4"><a href="rls.html#cb18-4" tabindex="-1"></a></span>
<span id="cb18-5"><a href="rls.html#cb18-5" tabindex="-1"></a><span class="co"># 2. Variables</span></span>
<span id="cb18-6"><a href="rls.html#cb18-6" tabindex="-1"></a>Y <span class="ot">&lt;-</span> df<span class="sc">$</span>Resistencia</span>
<span id="cb18-7"><a href="rls.html#cb18-7" tabindex="-1"></a>X <span class="ot">&lt;-</span> df<span class="sc">$</span>Edad</span>
<span id="cb18-8"><a href="rls.html#cb18-8" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(X)</span>
<span id="cb18-9"><a href="rls.html#cb18-9" tabindex="-1"></a></span>
<span id="cb18-10"><a href="rls.html#cb18-10" tabindex="-1"></a><span class="co"># 3. Medias</span></span>
<span id="cb18-11"><a href="rls.html#cb18-11" tabindex="-1"></a>x_bar <span class="ot">&lt;-</span> <span class="fu">mean</span>(X)</span>
<span id="cb18-12"><a href="rls.html#cb18-12" tabindex="-1"></a>y_bar <span class="ot">&lt;-</span> <span class="fu">mean</span>(Y)</span>
<span id="cb18-13"><a href="rls.html#cb18-13" tabindex="-1"></a></span>
<span id="cb18-14"><a href="rls.html#cb18-14" tabindex="-1"></a><span class="co"># 4. Cálculo de Sxx y Sxy</span></span>
<span id="cb18-15"><a href="rls.html#cb18-15" tabindex="-1"></a>Sxx <span class="ot">&lt;-</span> <span class="fu">sum</span>((X <span class="sc">-</span> x_bar)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb18-16"><a href="rls.html#cb18-16" tabindex="-1"></a>Sxy <span class="ot">&lt;-</span> <span class="fu">sum</span>((X <span class="sc">-</span> x_bar) <span class="sc">*</span> (Y <span class="sc">-</span> y_bar))</span>
<span id="cb18-17"><a href="rls.html#cb18-17" tabindex="-1"></a></span>
<span id="cb18-18"><a href="rls.html#cb18-18" tabindex="-1"></a><span class="co"># 5. Estimadores de mínimos cuadrados</span></span>
<span id="cb18-19"><a href="rls.html#cb18-19" tabindex="-1"></a>beta1 <span class="ot">&lt;-</span> Sxy <span class="sc">/</span> Sxx</span>
<span id="cb18-20"><a href="rls.html#cb18-20" tabindex="-1"></a></span>
<span id="cb18-21"><a href="rls.html#cb18-21" tabindex="-1"></a><span class="co"># 6. Estimador beta0</span></span>
<span id="cb18-22"><a href="rls.html#cb18-22" tabindex="-1"></a>beta0 <span class="ot">&lt;-</span> y_bar <span class="sc">-</span> beta1 <span class="sc">*</span> x_bar</span>
<span id="cb18-23"><a href="rls.html#cb18-23" tabindex="-1"></a></span>
<span id="cb18-24"><a href="rls.html#cb18-24" tabindex="-1"></a><span class="co"># 7. Valores ajustados</span></span>
<span id="cb18-25"><a href="rls.html#cb18-25" tabindex="-1"></a>Y_hat <span class="ot">&lt;-</span> beta0 <span class="sc">+</span> beta1 <span class="sc">*</span> X</span>
<span id="cb18-26"><a href="rls.html#cb18-26" tabindex="-1"></a></span>
<span id="cb18-27"><a href="rls.html#cb18-27" tabindex="-1"></a><span class="co"># 8. Sumas de cuadrados</span></span>
<span id="cb18-28"><a href="rls.html#cb18-28" tabindex="-1"></a>SST <span class="ot">&lt;-</span> <span class="fu">sum</span>((Y <span class="sc">-</span> y_bar)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb18-29"><a href="rls.html#cb18-29" tabindex="-1"></a>SSE <span class="ot">&lt;-</span> <span class="fu">sum</span>((Y <span class="sc">-</span> Y_hat)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb18-30"><a href="rls.html#cb18-30" tabindex="-1"></a>SSR <span class="ot">&lt;-</span> SST <span class="sc">-</span> SSE  <span class="co"># también se puede calcular como sum((Y_hat - y_bar)^2)</span></span>
<span id="cb18-31"><a href="rls.html#cb18-31" tabindex="-1"></a></span>
<span id="cb18-32"><a href="rls.html#cb18-32" tabindex="-1"></a><span class="co"># 9. Coeficiente de determinación</span></span>
<span id="cb18-33"><a href="rls.html#cb18-33" tabindex="-1"></a>R2 <span class="ot">&lt;-</span> SSR <span class="sc">/</span> SST</span>
<span id="cb18-34"><a href="rls.html#cb18-34" tabindex="-1"></a>R2</span></code></pre></div>
</details>
<pre><code>## [1] 0.7792861</code></pre>
<ul>
<li>Otra forma de calcular el coefiente de determinación es</li>
</ul>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="rls.html#cb20-1" tabindex="-1"></a><span class="do">## coeficiente de determinación</span></span>
<span id="cb20-2"><a href="rls.html#cb20-2" tabindex="-1"></a>rho_est <span class="ot">&lt;-</span> <span class="fu">with</span>(df, <span class="fu">cor</span>(Resistencia, Edad))</span>
<span id="cb20-3"><a href="rls.html#cb20-3" tabindex="-1"></a>rho_est<span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
</details>
<pre><code>## [1] 0.7792861</code></pre>
<ul>
<li>Ahora, usando la función <code>lm</code></li>
</ul>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="rls.html#cb22-1" tabindex="-1"></a><span class="co"># ajuste del modelo de RLS</span></span>
<span id="cb22-2"><a href="rls.html#cb22-2" tabindex="-1"></a>modelo <span class="ot">&lt;-</span> <span class="fu">lm</span>(Resistencia <span class="sc">~</span> Edad, <span class="at">data =</span> df)</span>
<span id="cb22-3"><a href="rls.html#cb22-3" tabindex="-1"></a></span>
<span id="cb22-4"><a href="rls.html#cb22-4" tabindex="-1"></a><span class="co"># obtención del R^2 a partir de un objeto lm</span></span>
<span id="cb22-5"><a href="rls.html#cb22-5" tabindex="-1"></a><span class="fu">summary</span>(modelo)<span class="sc">$</span>r.squared    </span></code></pre></div>
</details>
<pre><code>## [1] 0.7792861</code></pre>
<div class="admon-box ejercicio">
<div class="admon-title">
<span class="icon"></span> Ejercicio 1
</div>
<p>
Todos los meses, durante cierto período, se midieron la temperatura promedio en °C (x)
y el número de libras de vapor (y) consumidas por cierta planta química.
La recta de mínimos cuadrados calculada de los datos resultantes es:
</p>
<p>
<span class="math inline">\(\hat{y} = 245.82 + 1.13x\)</span>
</p>
<ol type="a">
<li>
Pronostique el número de libras del vapor consumido en un mes donde la temperatura promedio es 65 °C.
</li>
<li>
Si dos meses difieren en sus temperaturas promedio por 5 °C, ¿cuánto predice que será diferente el número de libras del vapor consumido?
</li>
</ol>
</div>
<div class="admon-box ejercicio">
<div class="admon-title">
<span class="icon"></span> Ejercicio 2
</div>
<p>
En un estudio de la relación entre la dureza de Brinell (x) y la tensión de compresión en ksi (y) de elementos de cobre extruidos en frío,
la recta de mínimos cuadrados fue:
</p>
<p>
<span class="math inline">\(\hat{y} = -196.32 + 2.42x\)</span>
</p>
<ol type="a">
<li>
Pronostique la fuerza de tensión de un elemento cuya dureza de Brinell es 102.7.
</li>
<li>
Si dos muestras difieren en su dureza de Brinell en 3, ¿cuánto predice que serán diferentes sus tensiones de compresión?
</li>
</ol>
</div>
<div class="admon-box ejercicio">
<div class="admon-title">
<span class="icon"></span> Ejercicio 3
</div>
<p>
Una recta de mínimos cuadrados está ajustando a un conjunto de puntos.
Si la suma total de los cuadrados es <span class="math inline">\(\sum (y_i - \bar{y})^2 = 9615\)</span>,
y la suma de los cuadrados de los errores es <span class="math inline">\(\sum (y_i - \hat{y}_i)^2 = 1450\)</span>,
calcule el coeficiente de determinación <span class="math inline">\(R^2\)</span>.
</p>
</div>
<div class="admon-box ejercicio">
<div class="admon-title">
<span class="icon"></span> Ejercicio 4
</div>
<p>
Una recta de mínimos cuadrados está ajustando un conjunto de puntos.
Si la suma total de cuadrados es <span class="math inline">\(\sum (y_i - \bar{y})^2 = 181.2\)</span>,
y la suma de los cuadrados de los errores es <span class="math inline">\(\sum (y_i - \hat{y}_i)^2 = 33.9\)</span>,
calcule el coeficiente de determinación <span class="math inline">\(R^2\)</span>.
</p>
</div>
<div class="admon-box ejercicio">
<div class="admon-title">
<span class="icon"></span> Ejercicio 5
</div>
<p>
Con los datos de las estaturas de Galton, la recta de mínimos cuadrados para pronosticar la longitud del antebrazo (y) de la estatura (x) es:
</p>
<p>
<span class="math inline">\(\hat{y} = -0.2967 + 0.2738x\)</span>
</p>
<ol type="a">
<li>
Pronostique la longitud del antebrazo de un hombre cuya estatura es 70 pulgadas.
</li>
<li>
¿Qué estatura debe tener un hombre con el propósito de que se pronostique que su longitud de antebrazo sea de 19 pulgadas?
</li>
<li>
Todos los hombres en cierto grupo tienen 72 pulgadas de estatura.
Explique por qué la pendiente de la recta de mínimos cuadrados es menos de 1
si ambos, las estaturas y los antebrazos se miden en las mismas unidades (pulgadas).
</li>
</ol>
</div>
<div class="admon-box ejercicio">
<div class="admon-title">
<span class="icon"></span> Ejercicio 6
</div>
<p>
Los adelantos tecnológicos han hecho posible fabricar botes inflables. Estos botes de goma inflables,
que pueden enrollarse formando un paquete no mayor que una bolsa de golf, tienen tamaño suficiente para
dos pasajeros con su equipo de excursionismo.
</p>
<p>
La revista <em>Canoe &amp; Kayac</em> probó los botes de nueve fabricantes para ver su funcionamiento en un
recorrido de tres días. Uno de los criterios de evaluación fue su capacidad para equipaje que se evaluó
utilizando una escala de 4 puntos, siendo 1 la puntuación más baja y 4 la puntuación más alta.
</p>
<p>
Los datos siguientes muestran la evaluación que obtuvieron respecto a capacidad para equipaje y los precios
de los botes (<em>Canoe Kayak</em>, marzo 2003).
</p>
<table>
<thead>
<tr>
<th>
Bote
</th>
<th>
Capacidad para equipaje
</th>
<th>
Precio ($)
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
S14
</td>
<td>
4
</td>
<td>
1595
</td>
</tr>
<tr>
<td>
Orinoco
</td>
<td>
4
</td>
<td>
1399
</td>
</tr>
<tr>
<td>
Outside Pro
</td>
<td>
4
</td>
<td>
1890
</td>
</tr>
<tr>
<td>
Explorer 380X
</td>
<td>
3
</td>
<td>
795
</td>
</tr>
<tr>
<td>
River XK2
</td>
<td>
2.5
</td>
<td>
600
</td>
</tr>
<tr>
<td>
Sea Tiger
</td>
<td>
4
</td>
<td>
1995
</td>
</tr>
<tr>
<td>
Maverik II
</td>
<td>
3
</td>
<td>
1205
</td>
</tr>
<tr>
<td>
Starlite 100
</td>
<td>
2
</td>
<td>
583
</td>
</tr>
<tr>
<td>
Fat Pack Cat
</td>
<td>
3
</td>
<td>
1048
</td>
</tr>
</tbody>
</table>
<ol>
<li>
Trace el diagrama de dispersión de estos datos empleando la capacidad para equipaje como variable independiente.
</li>
<li>
¿Qué indica el diagrama de dispersión del inciso a) respecto a la relación entre capacidad para equipaje y precio?
</li>
<li>
A través de los puntos de los datos trace una línea recta para aproximar la relación lineal entre capacidad para equipaje y precio.
</li>
<li>
Utilice el método de mínimos cuadrados para obtener la ecuación de regresión estimada.
</li>
<li>
Dé una interpretación de la pendiente de la ecuación de regresión estimada.
</li>
<li>
Diga cuál será el precio de un bote que tenga 3 en la evaluación de su capacidad para equipaje.
</li>
</ol>
</div>
<div class="admon-box ejercicio">
<div class="admon-title">
<span class="icon"></span> Ejercicio 7
</div>
<p>
Wageweb realiza estudios sobre datos salariales y presenta resúmenes de éstos en su sitio de la Red.
Basándose en datos salariales desde el 1 de octubre de 2002, Wageweb publicó que el salario anual promedio
de los vicepresidentes de ventas era $142 111 con una gratificación anual promedio de $15 432
(<em>Wageweb.com</em>, 13 de marzo de 2003).
</p>
<p>
Suponga que los datos siguientes sean una muestra de salarios y bonos anuales de 10 vicepresidentes de ventas.
Los datos se dan en miles de dólares.
</p>
<table>
<thead>
<tr>
<th>
Vicepresidente
</th>
<th>
Salario
</th>
<th>
Gratificación
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
<td>
135
</td>
<td>
12
</td>
</tr>
<tr>
<td>
2
</td>
<td>
115
</td>
<td>
14
</td>
</tr>
<tr>
<td>
3
</td>
<td>
147
</td>
<td>
16
</td>
</tr>
<tr>
<td>
4
</td>
<td>
167
</td>
<td>
22
</td>
</tr>
<tr>
<td>
5
</td>
<td>
165
</td>
<td>
24
</td>
</tr>
<tr>
<td>
6
</td>
<td>
176
</td>
<td>
29
</td>
</tr>
<tr>
<td>
7
</td>
<td>
98
</td>
<td>
7
</td>
</tr>
<tr>
<td>
8
</td>
<td>
136
</td>
<td>
17
</td>
</tr>
<tr>
<td>
9
</td>
<td>
163
</td>
<td>
21
</td>
</tr>
<tr>
<td>
10
</td>
<td>
119
</td>
<td>
11
</td>
</tr>
</tbody>
</table>
<ol>
<li>
Trace un diagrama de dispersión con estos datos tomando como variable independiente los salarios.
</li>
<li>
¿Qué indica el diagrama de dispersión del inciso a) acerca de la relación entre salario y gratificación?
</li>
<li>
Use el método de mínimos cuadrados para obtener la ecuación de regresión estimada.
</li>
<li>
Dé una interpretación de la ecuación de regresión estimada.
</li>
<li>
¿Cuál será la gratificación de un vicepresidente que tenga un salario anual de $120 000?
</li>
</ol>
</div>
<div class="admon-box ejercicio">
<div class="admon-title">
<span class="icon"></span> Ejercicio 8
</div>
<p>
Se midió el peso inercial (en toneladas) y el ahorro de combustible (en milla/galón)
para una muestra de siete camiones de diésel. En la tabla siguiente se presentan los resultados.
(De “In—Use Emissions from Heavy—Duty Diesel Vehicles,” J. Yanowitz, tesis de doctorado,
Escuela de Minas de Colorado, 2001.)
</p>
<table>
<thead>
<tr>
<th>
Peso
</th>
<th>
Millaje
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
8.00
</td>
<td>
7.69
</td>
</tr>
<tr>
<td>
24.50
</td>
<td>
4.97
</td>
</tr>
<tr>
<td>
27.00
</td>
<td>
4.56
</td>
</tr>
<tr>
<td>
14.50
</td>
<td>
6.49
</td>
</tr>
<tr>
<td>
28.50
</td>
<td>
4.34
</td>
</tr>
<tr>
<td>
12.75
</td>
<td>
6.24
</td>
</tr>
<tr>
<td>
21.25
</td>
<td>
4.45
</td>
</tr>
</tbody>
</table>
<ol>
<li>
Construya un diagrama de puntos del millaje (y) contra el peso (x). Compruebe que un modelo lineal es adecuado.
</li>
<li>
Calcule la recta de mínimos cuadrados para pronosticar el millaje a partir del peso.
</li>
<li>
Si los dos camiones son diferentes en peso por cinco toneladas, ¿cuánto predeciría que son diferentes sus millajes?
</li>
<li>
Pronostique el millaje para camiones con un peso de 15 toneladas.
</li>
<li>
¿Cuáles son las unidades de la pendiente estimada <span class="math inline">\(\hat{\beta}_1\)</span>?
</li>
<li>
¿Cuáles son las unidades del intercepto estimado <span class="math inline">\(\hat{\beta}_0\)</span>?
</li>
</ol>
</div>
<div class="admon-box ejercicio">
<div class="admon-title">
<span class="icon"></span> Ejercicio 9
</div>
<p>
El procesamiento de carbón natural implica el “lavado” durante el cual se elimina ceniza de carbón
(no orgánico, material no combustible). El artículo <em>“Quantifying Sampling Precision for Coal Ash
Using Gy’s Discrete Model of the Fundamental Error”</em>
(<em>Journal of Coal Quality</em>, 1989, 33-39) proporciona los datos relacionados con los porcentajes
de ceniza con la densidad de una partícula de carbón.
</p>
<p>
Se midió el promedio de porcentaje de ceniza para cinco densidades de partículas de carbón.
En la tabla siguiente se presentan los datos:
</p>
<table>
<thead>
<tr>
<th>
Densidad (g/cm³)
</th>
<th>
Porcentaje de ceniza
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
1.25
</td>
<td>
1.93
</td>
</tr>
<tr>
<td>
1.325
</td>
<td>
4.63
</td>
</tr>
<tr>
<td>
1.375
</td>
<td>
8.95
</td>
</tr>
<tr>
<td>
1.45
</td>
<td>
15.05
</td>
</tr>
<tr>
<td>
1.55
</td>
<td>
23.31
</td>
</tr>
</tbody>
</table>
<ol>
<li>
Construya un diagrama de dispersión del porcentaje de ceniza (y) contra la densidad (x). Verifique que es adecuado un modelo lineal.
</li>
<li>
Calcule la recta de mínimos cuadrados para pronosticar porcentaje de ceniza a partir de la densidad.
</li>
<li>
Si las dos partículas de carbón difieren en densidad por 0.1 g/cm³, ¿cuánto predeciría que será diferente el porcentaje de ceniza?
</li>
<li>
Pronostique el porcentaje de ceniza para partículas con 1.40 g/cm³.
</li>
<li>
Calcule los valores ajustados.
</li>
<li>
Calcule los residuos. ¿Qué punto tiene el residuo con magnitud mayor?
</li>
<li>
Calcule la correlación entre la densidad y el porcentaje de ceniza.
</li>
<li>
Haga la suma de cuadrados de regresión, la suma de cuadrados del error y la suma total de cuadrados.
</li>
<li>
Divida la suma de cuadrados de regresión entre la suma total de cuadrados. ¿Cuál es la relación entre esta cantidad y el coeficiente de correlación?
</li>
</ol>
</div>
<div class="admon-box ejercicio">
<div class="admon-title">
<span class="icon"></span> Ejercicio 10
</div>
<p>
Un ingeniero quiere pronosticar el valor de <em>y</em> cuando <em>x = 4.5</em> utilizando el siguiente conjunto de datos:
</p>
<table>
<thead>
<tr>
<th>
x
</th>
<th>
y
</th>
<th>
z = ln y
</th>
<th>
x
</th>
<th>
y
</th>
<th>
z = ln y
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
1
</td>
<td>
0.2
</td>
<td>
-1.61
</td>
<td>
6
</td>
<td>
2.3
</td>
<td>
0.83
</td>
</tr>
<tr>
<td>
2
</td>
<td>
0.3
</td>
<td>
-1.20
</td>
<td>
7
</td>
<td>
2.9
</td>
<td>
1.06
</td>
</tr>
<tr>
<td>
3
</td>
<td>
0.5
</td>
<td>
-0.69
</td>
<td>
8
</td>
<td>
4.5
</td>
<td>
1.50
</td>
</tr>
<tr>
<td>
4
</td>
<td>
0.5
</td>
<td>
-0.69
</td>
<td>
9
</td>
<td>
8.7
</td>
<td>
2.16
</td>
</tr>
<tr>
<td>
5
</td>
<td>
1.3
</td>
<td>
0.26
</td>
<td>
10
</td>
<td>
12.0
</td>
<td>
2.48
</td>
</tr>
</tbody>
</table>
<ol>
<li>
Construya un diagrama de dispersión de los puntos (x, y).
</li>
<li>
¿La recta de mínimos cuadrados se debe utilizar para pronosticar el valor de y cuando x = 4.5?
Si es así, calcule la recta de mínimos cuadrados y el valor pronosticado. Si no, explique.
</li>
<li>
Construya un diagrama de dispersión de los puntos (x, z), donde z = ln y.
</li>
<li>
Utilice la recta de mínimos cuadrados para pronosticar el valor de z cuando x = 4.5.
¿Éste es un método adecuado de pronóstico? Explique por qué sí o no.
</li>
<li>
Sea ẑ el valor pronosticado de z calculado en el inciso d).
Sea ŷ = e<sup>ẑ</sup>. Explique por qué ŷ es un pronosticador razonable del valor de y cuando x = 4.5.
</li>
</ol>
</div>
</div>
<div id="propiedades-de-estimadores-de-mínimos-cuadrados" class="section level2 hasAnchor" number="7.5">
<h2><span class="header-section-number">7.5</span> Propiedades de estimadores de mínimos cuadrados<a href="#propiedades-de-estimadores-de-m%C3%ADnimos-cuadrados" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="admon-box teorema">
<div class="admon-title">
<span class="icon"></span> Teorema
</div>
<p>
<p>Sean <span class="math inline">\(\hat{\beta}_0\)</span> y <span class="math inline">\(\hat{\beta}_1\)</span> los estimadores de mínimos cuadrados de los parámetros
en un modelo de regresión lineal simple</p>
<p><span class="math display">\[\begin{align}
y_i &amp;= \beta_0 + \beta_1 x_i + \varepsilon_i, \\[6pt]
\varepsilon_i &amp;\sim N(0, \sigma^2).
\end{align}\]</span></p>
Entonces
</p>
<ol type="a">
<li>
<strong>Insesgado:</strong>
<span class="math display">\[
      E(\hat{\beta}_1) = \beta_1, \quad E(\hat{\beta}_0) = \beta_0
      \]</span>
</li>
<li>
<strong>Varianzas:</strong>
<span class="math display">\[
      \hat{\sigma}^2_{\hat{\beta}_1}=Var(\hat{\beta}_1) = \frac{\sigma^2}{S_{xx}}, \quad
      \hat{\sigma}^2_{\hat{\beta}_0}= Var(\hat{\beta}_0) = \sigma^2 \left(\frac{1}{n} + \frac{\bar{x}^2}{S_{xx}}\right)
      \]</span>
donde <span class="math inline">\(S_{xx} = \sum_{i=1}^{n} (x_i - \bar{x})^2\)</span>.
</li>
<li>
<strong>Distribuciones:</strong>
<span class="math display">\[
      \hat{\beta}_1 \sim N\left(\beta_1, \frac{\sigma^2}{S_{xx}}\right), \quad
      \hat{\beta}_0 \sim N\left(\beta_0, \sigma^2\left(\frac{1}{n} + \frac{\bar{x}^2}{S_{xx}}\right)\right)
      \]</span>
</li>
</ol>
</div>
<p style="text-align: left;">
<strong>Demostración del teorema</strong>
</p>
<p>Inicialmente probemos que <span class="math inline">\(E(\hat{\beta}_1) = \beta_1\)</span>. En efecto</p>
<p><span class="math display">\[
\hat{\beta}_1=\frac{S_{xy}}{S_{xx}},
\qquad S_{xy}=\sum_{i=1}^n (x_i-\bar x)(y_i-\bar y),
\qquad S_{xx}=\sum_{i=1}^n (x_i-\bar x)^2&gt;0.
\]</span></p>
<p>Ahora,</p>
<p><span class="math display">\[\begin{align}
\sum_{i=1}^n (x_i - \bar{x}) &amp;= \sum_{i=1}^n x_i - \sum_{i=1}^n \bar{x} = \sum_{i=1}^n x_i - n\bar{x} \\[6pt]
&amp;= \sum_{i=1}^n x_i - n\left(\tfrac{1}{n}\sum_{i=1}^n x_i\right)= \sum_{i=1}^n x_i - \sum_{i=1}^n x_i = 0.
\end{align}\]</span></p>
<p>Como <span class="math inline">\(\sum_{i=1}^n (x_i-\bar x)=0\)</span> se tiene que</p>
<p><span class="math display">\[\begin{align}
S_{xy}
&amp;= \sum_{i=1}^n (x_i-\bar x)y_i - \bar y \sum_{i=1}^n (x_i-\bar x) \\
&amp;= \sum_{i=1}^n (x_i-\bar x)\, y_i,
\end{align}\]</span></p>
<p>de modo que</p>
<p><span class="math display">\[
\hat{\beta}_1=\frac{\sum_{i=1}^n (x_i-\bar x)\, y_i}{S_{xx}}.
\]</span></p>
<p>Sustituyendo el modelo <span class="math inline">\(y_i=\beta_0+\beta_1 x_i+\varepsilon_i\)</span> tenemos que</p>
<p><span class="math display">\[\begin{align}
\sum_{i=1}^n (x_i-\bar x) y_i
&amp;= \sum_{i=1}^n (x_i-\bar x)(\beta_0+\beta_1 x_i+\varepsilon_i) \\
&amp;= \beta_0 \sum_{i=1}^n (x_i-\bar x)
   + \beta_1 \sum_{i=1}^n (x_i-\bar x)x_i
   + \sum_{i=1}^n (x_i-\bar x)\varepsilon_i \\
&amp;= 0
   + \beta_1 \sum_{i=1}^n (x_i-\bar x)x_i
   + \sum_{i=1}^n (x_i-\bar x)\varepsilon_i\\
   &amp;= \beta_1 \sum_{i=1}^n (x_i-\bar x)x_i
   + \sum_{i=1}^n (x_i-\bar x)\varepsilon_i.
\end{align}\]</span></p>
<p>Por otro lado,</p>
<p><span class="math display">\[\begin{align}
\sum_{i=1}^n (x_i - \bar{x})x_i
&amp;= \sum_{i=1}^n \big[(x_i - \bar{x})(x_i - \bar{x} + \bar{x})\big] \\[6pt]
&amp;= \sum_{i=1}^n (x_i - \bar{x})^2 + \bar{x}\sum_{i=1}^n (x_i - \bar{x}) \\[6pt]
&amp;= \sum_{i=1}^n (x_i - \bar{x})^2 + \bar{x}\cdot 0 \\[6pt]
&amp;= \sum_{i=1}^n (x_i - \bar{x})^2 \\[6pt]
&amp;= S_{xx}.
\end{align}\]</span></p>
<p>Usando la identidad <span class="math inline">\(\sum_{i=1}^n (x_i-\bar x)x_i = S_{xx}\)</span> se sigue que</p>
<p><span class="math display">\[
\sum_{i=1}^n (x_i-\bar x) y_i = \beta_1 S_{xx} + \sum_{i=1}^n (x_i-\bar x)\varepsilon_i.
\]</span></p>
<p>Por tanto
<span class="math display">\[
\hat{\beta}_1
= \frac{\beta_1 S_{xx} + \sum_{i=1}^n (x_i-\bar x)\varepsilon_i}{S_{xx}}
= \beta_1 + \frac{\sum_{i=1}^n (x_i-\bar x)\varepsilon_i}{S_{xx}}.
\]</span></p>
<p>Como <span class="math inline">\(\hat{\beta}_1\)</span> se construye con los <span class="math inline">\(x_i\)</span> y los <span class="math inline">\(\varepsilon_i\)</span>, al condicionar en <span class="math inline">\(X\)</span> quitamos la incertidumbre de los <span class="math inline">\(x_i\)</span> y nos quedamos solo con la parte aleatoria de los errores, por lo que</p>
<p><span class="math display">\[\begin{align}
E[\hat{\beta}_1 \mid X]
&amp;= \beta_1 + \frac{\sum_{i=1}^{n} (x_i-\bar x) E[\varepsilon_i]}{S_{xx}}
= \beta_1 + \frac{0}{S_{xx}}
= \beta_1.
\end{align}\]</span></p>
<p>Como la igualdad es cierta para cualquier conjunto de valores <span class="math inline">\(X\)</span>, se concluye que</p>
<p><span class="math display">\[
\boxed{\,E(\hat{\beta}_1)=\beta_1\,}
\]</span></p>
<p>Ahora, probemos que <span class="math inline">\(E(\hat{\beta}_0)=\beta_0\)</span>. En efecto, sabemos que <span class="math inline">\(\hat{\beta}_0 = \overline{y} - \hat{\beta}_1 \overline{x}\)</span>, por lo que</p>
<p><span class="math display">\[\begin{align}
E[\hat{\beta}_0 \mid X]
&amp;= E[\overline{y} \mid X] - E[\hat{\beta}_1 \mid X]\overline{x} \\[6pt]
&amp;= E[\big(\beta_0 + \beta_1 \overline{x}\big) \mid X] - E[\hat{\beta}_1 \mid X]\overline{x} \\[6pt]
&amp;= \big(\beta_0 + \beta_1 \overline{x}\big) - \beta_1 \overline{x} \\[6pt]
&amp;= \beta_0.
\end{align}\]</span></p>
<p>Y como esta igualdad vale para cualquier conjunto de valores <span class="math inline">\(X\)</span></p>
<p><span class="math display">\[
\boxed{E(\hat{\beta}_0) = \beta_0}
\]</span></p>
<p>Por otro lado, probemos que <span class="math inline">\(V(\hat{\beta}_1) = \frac{\sigma^2}{S_{xx}}\)</span>. En efecto; anteriormente probamos que</p>
<p><span class="math display">\[\begin{align}
\hat{\beta}_1 = \beta_1 + \frac{\sum_{i=1}^{n} (x_i - \bar{x})\varepsilon_i}{S_{xx}},
\end{align}\]</span></p>
<p>Como <span class="math inline">\(Var(\beta_1)=0\)</span>, ya que <span class="math inline">\(\beta_1\)</span> es constante entonces</p>
<p><span class="math display">\[\begin{align}
Var(\hat{\beta}_1\mid X)
&amp;= Var\!\left(\frac{\sum_{i=1}^{n} (x_i - \bar{x})\varepsilon_i}{S_{xx}}\mid X\right).
\end{align}\]</span></p>
<p>Sabemos que los errores son independientes, <span class="math inline">\(E(\varepsilon_i)=0\)</span> y <span class="math inline">\(Var(\varepsilon_i)=\sigma\)</span> por lo que</p>
<p><span class="math display">\[\begin{align}
Var(\hat{\beta}_1\mid X)  
&amp;= \frac{1}{S_{xx}^2} \; Var\!\left(\sum_{i=1}^{n} (x_i - \bar{x})\varepsilon_i\mid X\right)=
\frac{1}{S_{xx}^2}Var\!\left(\sum_{i=1}^{n} (x_i - \bar{x})\varepsilon_i\mid X\right) \\[6pt]
&amp;= \frac{1}{S_{xx}^2}\sum_{i=1}^{n} (x_i - \bar{x})^2 Var(\varepsilon_i) = \frac{1}{S_{xx}^2}\sigma^2 \sum_{i=1}^{n} (x_i - \bar{x})^2 \\[6pt]
&amp;= \frac{1}{S_{xx}^2}\sigma^2 S_{xx}=\frac{\sigma^2}{S_{xx}}
\end{align}\]</span></p>
<p>En consecuencia</p>
<p><span class="math display">\[
\boxed{Var(\hat{\beta}_1)= \frac{\sigma^2}{S_{xx}}}
\]</span></p>
<p>Probemos que <span class="math inline">\(V(\hat{\beta}_0) = \sigma^2 \left(\frac{1}{n} + \frac{\bar{x}^2}{S_{xx}}\right)\)</span>. En efecto</p>
<p><span class="math display">\[\begin{align}
Var(\hat{\beta}_0\mid X)
&amp;= Var(\bar{y} - \hat{\beta}_1 \bar{y}\mid X) \\[6pt]
&amp;= Var(\bar{y}\mid X) + \bar{x}^2 Var(\hat{\beta}_1\mid X) - 2\bar{x}\,Cov(\bar{y},\hat{\beta}_1\mid X).
\end{align}\]</span></p>
<p>Pruebe <span class="math inline">\(Cov(\bar{y},\hat{\beta}_1\mid X) = 0\)</span>, entonces</p>
<p><span class="math display">\[\begin{align}
Var(\hat{\beta}_0\mid X)
&amp;= Var(\bar{y}\mid X) + \bar{x}^2 Var(\hat{\beta}_1\mid X)\\[6pt]
&amp;= \frac{\sigma^2}{n} + \bar{x}^2 \frac{\sigma^2}{S_{xx}}\\[6pt]
&amp;=\sigma^2\left(\frac{1}{n}+\frac{\bar{x}^2}{S_{xx}}\right)
\end{align}\]</span></p>
<p>Por lo tanto</p>
<p><span class="math display">\[
\boxed{Var(\hat{\beta}_0)= \sigma^2\left(\frac{1}{n}+\frac{\bar{x}^2}{S_{xx}}\right)}\quad\square
\]</span></p>
</div>
<div id="estimación-de-invervalos-de-confianza-y-prueba-de-hipótesis-para-beta_1-beta_0-y-sigma2" class="section level2 hasAnchor" number="7.6">
<h2><span class="header-section-number">7.6</span> Estimación de invervalos de confianza y prueba de hipótesis para <span class="math inline">\(\beta_1, \beta_0\)</span> y <span class="math inline">\(\sigma^2\)</span><a href="#estimaci%C3%B3n-de-invervalos-de-confianza-y-prueba-de-hip%C3%B3tesis-para-beta_1-beta_0-y-sigma2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Al utilizar un modelo de <strong>Regresión Lineal Simple (RLS)</strong> queremos estar seguros de que el modelo ajustado es <strong>considerablemente mejor</strong> que no tener dicho modelo.<br />
Esto equivale a determinar si la contribución del factor controlable <span class="math inline">\(X\)</span> para predecir <span class="math inline">\(E[Y \mid X = x_0]\)</span> es sustancial.</p>
<p>Formalmente, esto se traduce en realizar una <strong>prueba de significancia global</strong> para el modelo.</p>
<div class="admon-box observacion">
<div class="admon-title">
<span class="icon"></span> Observación
</div>
<p>La prueba de significancia global puede realizarse de dos maneras en RLS:
1. <strong>A través de un procedimiento de pruebas de hipótesis basado en la distribución <span class="math inline">\(t\)</span> de Student</strong>.
2. <strong>Utilizando los resultados de la Tabla ANOVA</strong>.</p>
</div>
<div id="intervalo-de-confianza-para-beta_1" class="section level3 hasAnchor" number="7.6.1">
<h3><span class="header-section-number">7.6.1</span> Intervalo de confianza para <span class="math inline">\(\beta_1\)</span><a href="rls.html#intervalo-de-confianza-para-beta_1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En un modelo de <strong>regresión lineal simple</strong>, queremos estimar el verdadero valor de la pendiente <span class="math inline">\(\beta_1\)</span>.</p>
<p>Para ello construimos un <strong>intervalo de confianza (IC)</strong> basado en la distribución muestral del estimador <span class="math inline">\(\hat{\beta}_1\)</span> y en las propiedades de los estimadores de mínimos cuadrados</p>
<ol style="list-style-type: decimal">
<li>El estadístico de prueba de la variable estandarizada es:</li>
</ol>
<p><span class="math display">\[
T = \frac{\hat{\beta}_1 - \beta_1}{\widehat{\sigma}_{\hat{\beta}_1}} \sim t_{(n-2)}
\]</span></p>
<p>donde <span class="math inline">\(t_{(n-2)}\)</span> es la distribución t de Student con <span class="math inline">\(n-2\)</span> grados de libertad.</p>
<p>cuya expresión de probabilidad definida de un intervalo de confianza es</p>
<p><span class="math display">\[
P\left(-t_{\alpha/2,\,n-2} &lt; \frac{\hat{\beta}_1 - \beta_1}{\widehat{\sigma}_{\hat{\beta}_1}} &lt; t_{\alpha/2,\,n-2}\right) = 1-\alpha
\]</span></p>
<ol start="3" style="list-style-type: decimal">
<li>Reordenando la desigualdad y despejando <span class="math inline">\(\beta_1\)</span>, obtenemos el intervalo para la pendiente</li>
</ol>
<p><span class="math display">\[
\hat{\beta}_1 - t_{\alpha/2,\,n-2}\,\sqrt{\frac{\hat{\sigma}^2}{S_{xx}}}
\;&lt;\; \beta_1 \;&lt;\;
\hat{\beta}_1 + t_{\alpha/2,\,n-2}\,\sqrt{\frac{\hat{\sigma}^2}{S_{xx}}}
\tag{6.1}
\]</span></p>
<p>donde</p>
<ul>
<li><span class="math inline">\(\hat{\beta}_1\)</span>: estimador de la pendiente.<br />
</li>
<li><span class="math inline">\(t_{\alpha/2,\,n-2}\)</span>: valor crítico de la <span class="math inline">\(t\)</span> de Student.<br />
</li>
<li><span class="math inline">\(\hat{\sigma}^2\)</span>: estimador de la varianza residual.<br />
</li>
<li><span class="math inline">\(S_{xx} = \sum (x_i - \bar{x})^2\)</span>: suma de cuadrados de la variable explicativa.</li>
</ul>
<p>Con este intervalo, afirmamos que con una <strong>confianza <span class="math inline">\((1-\alpha)100\%\)</span></strong>, la verdadera pendiente <span class="math inline">\(\beta_1\)</span> se encuentra dentro de los límites calculados.</p>
<div class="admon-box observacion">
<div class="admon-title">
<span class="icon"></span> Observación
</div>
<p>
Cuando <span class="math inline">\(n-2&gt;30\)</span>, podemos aproximar la distribución <span class="math inline">\(t_{n-2}\)</span> a la distribución normal estándar. En <strong>R</strong>, utilizaríamos la <code>pnorm()</code> en lugar de <code>pt()</code>. Para más detalles, escriba <code>?pnorm</code> en la consola del <strong>R</strong>.
</p>
</div>
</div>
<div id="prueba-de-hipótesis-para-beta_1" class="section level3 hasAnchor" number="7.6.2">
<h3><span class="header-section-number">7.6.2</span> Prueba de hipótesis para <span class="math inline">\(\beta_1\)</span><a href="#prueba-de-hip%C3%B3tesis-para-beta_1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>El par de hipótesis más común en la regresión lineal simple se plantea sobre la pendiente <span class="math inline">\(\beta_1\)</span>:</p>
<p><span class="math display">\[
H_0: \beta_1 = 0
\quad \text{vs} \quad
H_1: \beta_1 \neq 0
\]</span></p>
<p>La interpretación de la hipótesis nula nos queda
- Si <span class="math inline">\(H_0\)</span> es verdadera, entonces <span class="math inline">\(E(Y \mid x) = \beta_0\)</span>, es decir, la variable explicativa <span class="math inline">\(x\)</span> <strong>no aporta información</strong> sobre la variable dependiente <span class="math inline">\(Y\)</span>.<br />
- La prueba se conoce como <strong>prueba de utilidad del modelo</strong>: verifica si la pendiente es significativamente distinta de cero.</p>
<p>Si <span class="math inline">\(H_0\)</span> es rechazada (para <span class="math inline">\(\alpha\)</span> pequeña), confirmamos la utilidad del modelo. Esto suele ocurrir cuando el coeficiente de determinación <span class="math inline">\(R^2\)</span> es grande.</p>
<p>El procedimiento de prueba es</p>
<ol style="list-style-type: decimal">
<li><p><strong>Planteamiento de hipótesis</strong><br />
<span class="math display">\[
H_0 : \beta_1 = 0
\quad \text{vs} \quad
H_1 : \beta_1 \neq 0
\]</span></p></li>
<li><p><strong>Cálculo del estadístico de prueba</strong><br />
<span class="math display">\[
t_0 = \frac{\hat{\beta}_1}{\sqrt{\dfrac{\hat{\sigma}^2}{S_{xx}}}}
\]</span></p></li>
<li><p><strong>Cálculo del valor p</strong><br />
<span class="math display">\[
P = 2P(T &gt; |t_0|), \quad T \sim t_{(n-2)}
\]</span></p></li>
</ol>
<p>de alli la decisión</p>
<ul>
<li>Si <span class="math inline">\(P &lt; \alpha\)</span>, <strong>rechazamos <span class="math inline">\(H_0\)</span></strong> → la variable explicativa <span class="math inline">\(x\)</span> aporta información significativa y el modelo es útil.<br />
</li>
<li>Si <span class="math inline">\(P \geq \alpha\)</span>, <strong>no rechazamos <span class="math inline">\(H_0\)</span></strong> → no hay evidencia suficiente para afirmar que <span class="math inline">\(\beta_1 \neq 0\)</span>.</li>
</ul>
</div>
<div id="intervalo-de-confianza-para-beta_0" class="section level3 hasAnchor" number="7.6.3">
<h3><span class="header-section-number">7.6.3</span> Intervalo de confianza para <span class="math inline">\(\beta_0\)</span><a href="rls.html#intervalo-de-confianza-para-beta_0" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En la regresión lineal simple, el estimador del intercepto es:</p>
<p><span class="math display">\[
\hat{\beta}_0 = \bar{y} - \hat{\beta}_1 \bar{y}
\]</span></p>
<p>Al igual que con la pendiente, el estadístico de prueba de la variable estandarizada es:</p>
<p><span class="math display">\[
T = \frac{\hat{\beta}_0 - \beta_0}{\widehat{\sigma}_{\hat{\beta}_0}} \sim t_{(n-2)}
\]</span></p>
<ol start="2" style="list-style-type: decimal">
<li>El error estándar de <span class="math inline">\(\hat{\beta}_0\)</span> es:</li>
</ol>
<p><span class="math display">\[
\widehat{\sigma}_{\hat{\beta}_0} =
\sqrt{\hat{\sigma}^2 \left( \frac{1}{n} + \frac{\bar{x}^2}{S_{xx}} \right)}
\]</span></p>
<p>donde</p>
<ul>
<li><span class="math inline">\(n\)</span>: número de observaciones.<br />
</li>
<li><span class="math inline">\(\bar{x}\)</span>: media de la variable explicativa.<br />
</li>
<li><span class="math inline">\(S_{xx} = \sum (x_i - \bar{x})^2\)</span>.<br />
</li>
<li><span class="math inline">\(\hat{\sigma}^2\)</span>: estimador de la varianza residual.</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>A partir de la expresión de probabilidad, se obtiene que el intervalo de confianza <span class="math inline">\((1-\alpha)100\%\)</span> para <span class="math inline">\(\beta_0\)</span> es:</li>
</ol>
<p><span class="math display">\[
\hat{\beta}_0 - t_{\alpha/2,\,n-2}\,\sqrt{\hat{\sigma}^2 \left( \tfrac{1}{n} + \tfrac{\bar{x}^2}{S_{xx}} \right)}
\;&lt;\; \beta_0 \;&lt;\;
\hat{\beta}_0 + t_{\alpha/2,\,n-2}\,\sqrt{\hat{\sigma}^2 \left( \tfrac{1}{n} + \tfrac{\bar{x}^2}{S_{xx}} \right)}
\]</span>
donde</p>
<ul>
<li><span class="math inline">\(\hat{\beta}_0\)</span>: estimador del intercepto.<br />
</li>
<li><span class="math inline">\(t_{\alpha/2,\,n-2}\)</span>: valor crítico de la distribución t de Student.<br />
</li>
<li><span class="math inline">\(\widehat{\sigma}_{\hat{\beta}_0}\)</span>: error estándar del intercepto.</li>
</ul>
<p>Por lo que el intervalo nos da un rango en el cual se encuentra con probabilidad <span class="math inline">\((1-\alpha)\)</span> el verdadero valor del <strong>intercepto</strong> <span class="math inline">\(\beta_0\)</span>, es decir, el valor esperado de <span class="math inline">\(Y\)</span> cuando <span class="math inline">\(X = 0\)</span>.</p>
</div>
<div id="prueba-de-hipótesis-para-beta_0" class="section level3 hasAnchor" number="7.6.4">
<h3><span class="header-section-number">7.6.4</span> Prueba de hipótesis para <span class="math inline">\(\beta_0\)</span><a href="#prueba-de-hip%C3%B3tesis-para-beta_0" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>El contraste de hipótesis más común sobre el intercepto <span class="math inline">\(\beta_0\)</span> es</p>
<p><span class="math display">\[
H_0 : \beta_0 = 0
\quad \text{vs} \quad
H_1 : \beta_0 \neq 0
\]</span></p>
<p>La interpretación de la hipótesis nula nos queda</p>
<ul>
<li>Si <span class="math inline">\(H_0\)</span> es verdadera, el modelo pasaría <strong>por el origen</strong>.<br />
</li>
<li>En este caso, el valor esperado de <span class="math inline">\(Y\)</span> cuando <span class="math inline">\(X=0\)</span> sería exactamente cero.<br />
</li>
<li>Rechazar <span class="math inline">\(H_0\)</span> sugiere que existe un <strong>desplazamiento inicial</strong> (intercepto distinto de cero) que debe ser tenido en cuenta en el modelo.</li>
</ul>
<p>El procedimiento de prueba se realiza así</p>
<ol style="list-style-type: decimal">
<li><p><strong>Planteamiento de hipótesis</strong><br />
<span class="math display">\[
H_0 : \beta_0 = 0
\quad \text{vs} \quad
H_1 : \beta_0 \neq 0
\]</span></p></li>
<li><p><strong>Cálculo del estadístico de prueba</strong><br />
<span class="math display">\[
t_0 = \frac{\hat{\beta}_0}{\widehat{\sigma}_{\hat{\beta}_0}}
\]</span></p>
<p>donde</p>
<p><span class="math display">\[
\widehat{\sigma}_{\hat{\beta}_0} =
\sqrt{\hat{\sigma}^2 \left( \frac{1}{n} + \frac{\bar{x}^2}{S_{xx}} \right)}
\]</span></p></li>
<li><p><strong>Cálculo del valor p</strong><br />
<span class="math display">\[
P = 2P(T &gt; |t_0|),
\quad T \sim t_{(n-2)}
\]</span></p></li>
</ol>
<p>La decisión nos queda</p>
<ul>
<li>Si <span class="math inline">\(P &lt; \alpha\)</span>, <strong>rechazamos <span class="math inline">\(H_0\)</span></strong>: el intercepto es significativamente distinto de cero.<br />
</li>
<li>Si <span class="math inline">\(P \geq \alpha\)</span>, <strong>no rechazamos <span class="math inline">\(H_0\)</span></strong>: no hay evidencia suficiente para afirmar que <span class="math inline">\(\beta_0 \neq 0\)</span>.</li>
</ul>
</div>
<div id="intervalo-de-confianza-para-sigma2" class="section level3 hasAnchor" number="7.6.5">
<h3><span class="header-section-number">7.6.5</span> Intervalo de confianza para <span class="math inline">\(\sigma^2\)</span><a href="rls.html#intervalo-de-confianza-para-sigma2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En la regresión lineal simple, la varianza del error <span class="math inline">\(\sigma^2\)</span> se estima mediante</p>
<p><span class="math display">\[
\hat{\sigma}^2 = \frac{SSE}{n-2}
= \frac{\sum_{i=1}^n (y_i - \hat{y}_i)^2}{n-2}
\]</span></p>
<p>donde <span class="math inline">\(SSE\)</span> es la suma de cuadrados de los residuos.</p>
<p>Hallemos el intervalo de confianza</p>
<ol style="list-style-type: decimal">
<li>La distribución muestral que se tiene es</li>
</ol>
<p><span class="math display">\[
\frac{(n-2)\hat{\sigma}^2}{\sigma^2} \sim \chi^2_{(n-2)}
\]</span></p>
<p>es decir, la cantidad <span class="math inline">\((n-2)\hat{\sigma}^2/\sigma^2\)</span> sigue una distribución <span class="math inline">\(\chi^2\)</span> con <span class="math inline">\(n-2\)</span> grados de libertad.</p>
<ol start="2" style="list-style-type: decimal">
<li>La expresión de probabilidad definida en un intervalo de confianza se deduce de</li>
</ol>
<p><span class="math display">\[
P\left( \chi^2_{\alpha/2,\,n-2} &lt; \frac{(n-2)\hat{\sigma}^2}{\sigma^2} &lt; \chi^2_{1-\alpha/2,\,n-2} \right) = 1-\alpha
\]</span></p>
<ol start="3" style="list-style-type: decimal">
<li>Reordenando la desigualdad y despejando <span class="math inline">\(\sigma^2\)</span>, el intervalo de confianza <span class="math inline">\((1-\alpha)100\%\)</span> para <span class="math inline">\(\sigma^2\)</span> es</li>
</ol>
<p><span class="math display">\[
\frac{(n-2)\hat{\sigma}^2}{\chi^2_{1-\alpha/2,\,n-2}}
\;&lt;\; \sigma^2 \;&lt;\;
\frac{(n-2)\hat{\sigma}^2}{\chi^2_{\alpha/2,\,n-2}}
\]</span></p>
<p>donde</p>
<ul>
<li><span class="math inline">\(\hat{\sigma}^2\)</span>: estimador de la varianza residual.<br />
</li>
<li><span class="math inline">\(\chi^2_{\alpha/2,\,n-2}\)</span> y <span class="math inline">\(\chi^2_{1-\alpha/2,\,n-2}\)</span>: valores críticos de la distribución <span class="math inline">\(\chi^2\)</span> con <span class="math inline">\(n-2\)</span> grados de libertad.<br />
Este intervalo proporciona un rango plausible para la varianza verdadera de los errores del modelo.</li>
</ul>
</div>
<div id="prueba-de-hipótesis-para-sigma2" class="section level3 hasAnchor" number="7.6.6">
<h3><span class="header-section-number">7.6.6</span> Prueba de hipótesis para <span class="math inline">\(\sigma^2\)</span><a href="#prueba-de-hip%C3%B3tesis-para-sigma2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En regresión lineal simple, la varianza de los errores <span class="math inline">\(\sigma^2\)</span> se puede contrastar mediante la hipótesis:</p>
<p><span class="math display">\[H_0: \sigma^2 = \sigma_0^2 \quad \text{vs.} \quad H_1: \sigma^2 \neq \sigma_0^2\]</span></p>
<div id="estadístico-de-prueba-1" class="section level4 hasAnchor" number="7.6.6.1">
<h4><span class="header-section-number">7.6.6.1</span> Estadístico de prueba<a href="#estad%C3%ADstico-de-prueba-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><span class="math display">\[
T \;=\; \frac{SSE}{\sigma_0^2}
\;=\; \frac{(n-2)\hat\sigma^2}{\sigma_0^2}
\;\sim\; \chi^2_{(n-2)}
\]</span></p>
<p>donde</p>
<ul>
<li><span class="math inline">\(SSE = \sum_{i=1}^n (y_i - \hat y_i)^2\)</span> es la suma de cuadrados de los errores.<br />
</li>
<li><span class="math inline">\(\hat\sigma^2 = SSE/(n-2)\)</span> es el estimador de la varianza residual.<br />
</li>
<li><span class="math inline">\(n-2\)</span> son los grados de libertad del modelo.</li>
</ul>
</div>
<div id="regla-de-decisión" class="section level4 hasAnchor" number="7.6.6.2">
<h4><span class="header-section-number">7.6.6.2</span> Regla de decisión<a href="#regla-de-decisi%C3%B3n" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><p><strong>Prueba bilateral</strong><br />
<span class="math display">\[\text{Rechazar } H_0 \text{ si }
T &lt; \chi^2_{\alpha/2,\;n-2}
\quad \text{o} \quad
T &gt; \chi^2_{1-\alpha/2,\;n-2}.\]</span></p></li>
<li><p><strong>Prueba unilateral superior</strong><br />
<span class="math display">\[
\text{Rechazar } H_0 \text{ si }
T &gt; \chi^2_{1-\alpha,\;n-2}.
\]</span></p></li>
<li><p><strong>Prueba unilateral inferior</strong><br />
<span class="math display">\[
\text{Rechazar } H_0 \text{ si }
T &lt; \chi^2_{\alpha,\;n-2}.
\]</span></p></li>
</ul>
<hr />
<ul>
<li>Continuando con el ejemplo de los datos de soldadura, hallemos los intervalos de confianza para <span class="math inline">\(\sigma, \beta_1,\beta_0\)</span> y veamos si son significativos o no.</li>
</ul>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="rls.html#cb24-1" tabindex="-1"></a><span class="co"># Lectura de datos</span></span>
<span id="cb24-2"><a href="rls.html#cb24-2" tabindex="-1"></a>file <span class="ot">&lt;-</span> <span class="st">&quot;data/data_rls.txt&quot;</span></span>
<span id="cb24-3"><a href="rls.html#cb24-3" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.table</span>(file, <span class="at">header =</span> <span class="cn">TRUE</span>)</span>
<span id="cb24-4"><a href="rls.html#cb24-4" tabindex="-1"></a></span>
<span id="cb24-5"><a href="rls.html#cb24-5" tabindex="-1"></a><span class="co"># Primeras 6 filas</span></span>
<span id="cb24-6"><a href="rls.html#cb24-6" tabindex="-1"></a><span class="fu">head</span>(df)</span></code></pre></div>
</details>
<pre><code>##   Resistencia Edad
## 1        10.9 18.7
## 2        10.6 19.1
## 3        13.4  9.3
## 4        10.7 17.5
## 5        13.0 14.6
## 6        13.1 12.8</code></pre>
<ul>
<li>Construyamos el modelo de regresión lineal</li>
</ul>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="rls.html#cb26-1" tabindex="-1"></a><span class="co"># ajuste del modelo de RLS</span></span>
<span id="cb26-2"><a href="rls.html#cb26-2" tabindex="-1"></a>modelo <span class="ot">&lt;-</span> <span class="fu">lm</span>(Resistencia <span class="sc">~</span> Edad, <span class="at">data =</span> df)</span>
<span id="cb26-3"><a href="rls.html#cb26-3" tabindex="-1"></a>modelo</span></code></pre></div>
</details>
<pre><code>## 
## Call:
## lm(formula = Resistencia ~ Edad, data = df)
## 
## Coefficients:
## (Intercept)         Edad  
##     15.7427      -0.2438</code></pre>
<ul>
<li>Estimemos el error estandar residual <span class="math inline">\(\hat{\sigma}\)</span>:</li>
</ul>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="rls.html#cb28-1" tabindex="-1"></a><span class="co"># estimación de sigma</span></span>
<span id="cb28-2"><a href="rls.html#cb28-2" tabindex="-1"></a><span class="fu">summary</span>(modelo)<span class="sc">$</span>sigma</span></code></pre></div>
</details>
<pre><code>## [1] 0.5908683</code></pre>
<ul>
<li>Ahora, hallemos el intervalo de confianza para <span class="math inline">\(\sigma^2\)</span>:</li>
</ul>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="rls.html#cb30-1" tabindex="-1"></a><span class="co"># intervalo de confianza para sigma^2</span></span>
<span id="cb30-2"><a href="rls.html#cb30-2" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb30-3"><a href="rls.html#cb30-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(df)</span>
<span id="cb30-4"><a href="rls.html#cb30-4" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">summary</span>(modelo)<span class="sc">$</span>sigma</span>
<span id="cb30-5"><a href="rls.html#cb30-5" tabindex="-1"></a>gl <span class="ot">&lt;-</span> n<span class="dv">-2</span></span>
<span id="cb30-6"><a href="rls.html#cb30-6" tabindex="-1"></a>lim_inf <span class="ot">&lt;-</span> gl<span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">qchisq</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>, gl)</span>
<span id="cb30-7"><a href="rls.html#cb30-7" tabindex="-1"></a>lim_sup <span class="ot">&lt;-</span> gl<span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">qchisq</span>(alpha<span class="sc">/</span><span class="dv">2</span>, gl)</span>
<span id="cb30-8"><a href="rls.html#cb30-8" tabindex="-1"></a><span class="fu">c</span>(<span class="at">lim_inf =</span> lim_inf, <span class="at">sigma2_hat =</span>sigma<span class="sc">^</span><span class="dv">2</span>, <span class="at">lim_sup =</span> lim_sup)</span></code></pre></div>
</details>
<pre><code>##    lim_inf sigma2_hat    lim_sup 
##  0.2688068  0.3491253  0.4719150</code></pre>
<p>Finalmente, con una confianza del <span class="math inline">\(95\%\)</span>, <span class="math inline">\(\sigma^2 \in (0.269,\;0.472)\)</span>. Ahora, como el valor <span class="math inline">\(0\)</span> <strong>no</strong> se encuentra en el intervalo de confianza, podemos afirmar que $
^2 &gt; 0$ a nivel poblacional.</p>
<p>Para obtener un intervalo de confianza del <span class="math inline">\(95\%\)</span> para <span class="math inline">\(\sigma\)</span>, basta calcular la raíz cuadrada de estos límites. Por lo tanto, <span class="math inline">\(\sigma \in (0.519,\;0.687)\)</span>.</p>
<div class="admon-box ejercicio">
<div class="admon-title">
<span class="icon"></span> Ejercicio
</div>
<p>Verifiquemos el contraste de la hipótesis:</p>
<p><span class="math display">\[H_0:\ \sigma^2 = 0.25
\quad\text{vs.}\quad
H_1:\ \sigma^2 \neq 0.25\]</span></p>
<p>con nivel de significancia <span class="math inline">\(\alpha = 0.05\)</span>.</p>
<p>El estadístico de prueba está dado por:</p>
<p><span class="math display">\[
T = \frac{(n-2)\hat\sigma^2}{0.25}
\;\;\sim\;\; \chi^2_{(n-2)}
\]</span></p>
<p>donde <span class="math inline">\(\hat\sigma^2 = 0.3491\)</span> es la varianza residual estimada y <span class="math inline">\(0.25\)</span> es el valor hipotético de referencia de la varianza poblacional.</p>
</div>
<hr />
<ul>
<li>Ahora, hallemos el intervalo de confianza para <span class="math inline">\(\beta_0\)</span></li>
</ul>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="rls.html#cb32-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(df)</span>
<span id="cb32-2"><a href="rls.html#cb32-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> df<span class="sc">$</span>Edad</span>
<span id="cb32-3"><a href="rls.html#cb32-3" tabindex="-1"></a>y <span class="ot">&lt;-</span> df<span class="sc">$</span>Resistencia</span>
<span id="cb32-4"><a href="rls.html#cb32-4" tabindex="-1"></a>x_bar <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb32-5"><a href="rls.html#cb32-5" tabindex="-1"></a>y_bar <span class="ot">&lt;-</span> <span class="fu">mean</span>(y)</span>
<span id="cb32-6"><a href="rls.html#cb32-6" tabindex="-1"></a></span>
<span id="cb32-7"><a href="rls.html#cb32-7" tabindex="-1"></a><span class="co"># Sxx</span></span>
<span id="cb32-8"><a href="rls.html#cb32-8" tabindex="-1"></a>Sxx <span class="ot">&lt;-</span> <span class="fu">sum</span>((x <span class="sc">-</span> x_bar)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb32-9"><a href="rls.html#cb32-9" tabindex="-1"></a></span>
<span id="cb32-10"><a href="rls.html#cb32-10" tabindex="-1"></a><span class="co"># Pendiente e intercepto</span></span>
<span id="cb32-11"><a href="rls.html#cb32-11" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">coef</span>(modelo)[<span class="dv">2</span>]</span>
<span id="cb32-12"><a href="rls.html#cb32-12" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="fu">coef</span>(modelo)[<span class="dv">1</span>]</span>
<span id="cb32-13"><a href="rls.html#cb32-13" tabindex="-1"></a></span>
<span id="cb32-14"><a href="rls.html#cb32-14" tabindex="-1"></a><span class="co"># Sigma estimada</span></span>
<span id="cb32-15"><a href="rls.html#cb32-15" tabindex="-1"></a>sigma_hat <span class="ot">&lt;-</span> <span class="fu">summary</span>(modelo)<span class="sc">$</span>sigma</span>
<span id="cb32-16"><a href="rls.html#cb32-16" tabindex="-1"></a></span>
<span id="cb32-17"><a href="rls.html#cb32-17" tabindex="-1"></a><span class="co"># Varianza de b0</span></span>
<span id="cb32-18"><a href="rls.html#cb32-18" tabindex="-1"></a>var_b0 <span class="ot">&lt;-</span> sigma_hat<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span>n <span class="sc">+</span> (x_bar<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>Sxx)</span>
<span id="cb32-19"><a href="rls.html#cb32-19" tabindex="-1"></a>se_b0 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(var_b0)</span>
<span id="cb32-20"><a href="rls.html#cb32-20" tabindex="-1"></a></span>
<span id="cb32-21"><a href="rls.html#cb32-21" tabindex="-1"></a><span class="co"># Valor crítico t</span></span>
<span id="cb32-22"><a href="rls.html#cb32-22" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb32-23"><a href="rls.html#cb32-23" tabindex="-1"></a>t_crit <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">2</span>)</span>
<span id="cb32-24"><a href="rls.html#cb32-24" tabindex="-1"></a></span>
<span id="cb32-25"><a href="rls.html#cb32-25" tabindex="-1"></a><span class="co"># Intervalo de confianza</span></span>
<span id="cb32-26"><a href="rls.html#cb32-26" tabindex="-1"></a>inferior <span class="ot">&lt;-</span> b0 <span class="sc">-</span> t_crit <span class="sc">*</span> se_b0</span>
<span id="cb32-27"><a href="rls.html#cb32-27" tabindex="-1"></a>superior <span class="ot">&lt;-</span> b0 <span class="sc">+</span> t_crit <span class="sc">*</span> se_b0</span>
<span id="cb32-28"><a href="rls.html#cb32-28" tabindex="-1"></a></span>
<span id="cb32-29"><a href="rls.html#cb32-29" tabindex="-1"></a><span class="fu">c</span>( <span class="at">LI =</span> inferior , <span class="at">beta0 =</span> b0, <span class="at">LS =</span> superior)</span></code></pre></div>
</details>
<pre><code>##    LI.(Intercept) beta0.(Intercept)    LS.(Intercept) 
##          15.38816          15.74275          16.09734</code></pre>
<ul>
<li>Ahora, verifiquemos la prueba de hipótesis <span class="math inline">\(H_0:\beta_0=0\, vs\, H_1:\beta_0\neq 0\)</span></li>
</ul>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="rls.html#cb34-1" tabindex="-1"></a><span class="co"># intercepto</span></span>
<span id="cb34-2"><a href="rls.html#cb34-2" tabindex="-1"></a>b0 <span class="ot">&lt;-</span> <span class="fu">coef</span>(modelo)[<span class="dv">1</span>]</span>
<span id="cb34-3"><a href="rls.html#cb34-3" tabindex="-1"></a></span>
<span id="cb34-4"><a href="rls.html#cb34-4" tabindex="-1"></a><span class="co"># se(b0) = sigma_hat * sqrt( 1/n + x̄^2 / Sxx )</span></span>
<span id="cb34-5"><a href="rls.html#cb34-5" tabindex="-1"></a>var_b0 <span class="ot">&lt;-</span> sigma_hat<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span>n <span class="sc">+</span> (x_bar<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>Sxx)</span>
<span id="cb34-6"><a href="rls.html#cb34-6" tabindex="-1"></a>se_b0 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(var_b0)</span>
<span id="cb34-7"><a href="rls.html#cb34-7" tabindex="-1"></a></span>
<span id="cb34-8"><a href="rls.html#cb34-8" tabindex="-1"></a><span class="co"># Hipótesis: H0: beta0 = 0 vs H1: beta0 != 0</span></span>
<span id="cb34-9"><a href="rls.html#cb34-9" tabindex="-1"></a></span>
<span id="cb34-10"><a href="rls.html#cb34-10" tabindex="-1"></a>t_calc <span class="ot">&lt;-</span> (b0 <span class="sc">-</span> <span class="dv">0</span>) <span class="sc">/</span> se_b0</span>
<span id="cb34-11"><a href="rls.html#cb34-11" tabindex="-1"></a>gl <span class="ot">&lt;-</span> n<span class="dv">-2</span></span>
<span id="cb34-12"><a href="rls.html#cb34-12" tabindex="-1"></a>p_valor <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(<span class="fu">abs</span>(t_calc), gl))</span></code></pre></div>
</details>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="rls.html#cb35-1" tabindex="-1"></a><span class="co"># Convertir a data.frame para tabla</span></span>
<span id="cb35-2"><a href="rls.html#cb35-2" tabindex="-1"></a>resultados <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb35-3"><a href="rls.html#cb35-3" tabindex="-1"></a>  <span class="at">beta0_hat =</span> b0,</span>
<span id="cb35-4"><a href="rls.html#cb35-4" tabindex="-1"></a>  <span class="at">se_beta0 =</span> se_b0,</span>
<span id="cb35-5"><a href="rls.html#cb35-5" tabindex="-1"></a>  <span class="at">estadistico_t =</span> t_calc,</span>
<span id="cb35-6"><a href="rls.html#cb35-6" tabindex="-1"></a>  <span class="at">gl =</span> gl,</span>
<span id="cb35-7"><a href="rls.html#cb35-7" tabindex="-1"></a>  <span class="at">p_value =</span> p_valor</span>
<span id="cb35-8"><a href="rls.html#cb35-8" tabindex="-1"></a>)</span>
<span id="cb35-9"><a href="rls.html#cb35-9" tabindex="-1"></a></span>
<span id="cb35-10"><a href="rls.html#cb35-10" tabindex="-1"></a><span class="co"># Mostrar tabla con kable</span></span>
<span id="cb35-11"><a href="rls.html#cb35-11" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(resultados, <span class="at">digits =</span> <span class="dv">4</span>,</span>
<span id="cb35-12"><a href="rls.html#cb35-12" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">&quot;Resultados de la prueba de hipótesis para β₀&quot;</span>)</span></code></pre></div>
</details>
<table>
<caption><span id="tab:b3">Tabla 7.1: </span>Resultados de la prueba de hipótesis para β₀</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">beta0_hat</th>
<th align="right">se_beta0</th>
<th align="right">estadistico_t</th>
<th align="right">gl</th>
<th align="right">p_value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">15.7427</td>
<td align="right">0.1787</td>
<td align="right">88.105</td>
<td align="right">98</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<hr />
<ul>
<li>Ahora, hallemos el intervalo de confianza para <span class="math inline">\(\beta_1\)</span></li>
</ul>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="rls.html#cb36-1" tabindex="-1"></a><span class="co"># Pendiente</span></span>
<span id="cb36-2"><a href="rls.html#cb36-2" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">coef</span>(modelo)[<span class="dv">2</span>]</span>
<span id="cb36-3"><a href="rls.html#cb36-3" tabindex="-1"></a></span>
<span id="cb36-4"><a href="rls.html#cb36-4" tabindex="-1"></a><span class="co"># Varianza y error estándar de b1</span></span>
<span id="cb36-5"><a href="rls.html#cb36-5" tabindex="-1"></a>var_b1 <span class="ot">&lt;-</span> sigma_hat<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> Sxx</span>
<span id="cb36-6"><a href="rls.html#cb36-6" tabindex="-1"></a>se_b1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(var_b1)</span>
<span id="cb36-7"><a href="rls.html#cb36-7" tabindex="-1"></a></span>
<span id="cb36-8"><a href="rls.html#cb36-8" tabindex="-1"></a><span class="co"># Valor crítico t (ya lo tenías calculado)</span></span>
<span id="cb36-9"><a href="rls.html#cb36-9" tabindex="-1"></a>t_calc <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">2</span>)</span>
<span id="cb36-10"><a href="rls.html#cb36-10" tabindex="-1"></a></span>
<span id="cb36-11"><a href="rls.html#cb36-11" tabindex="-1"></a><span class="co"># Intervalo de confianza para beta_1</span></span>
<span id="cb36-12"><a href="rls.html#cb36-12" tabindex="-1"></a>inferior <span class="ot">&lt;-</span> b1 <span class="sc">-</span> t_calc<span class="sc">*</span> se_b1</span>
<span id="cb36-13"><a href="rls.html#cb36-13" tabindex="-1"></a>superior <span class="ot">&lt;-</span> b1 <span class="sc">+</span> t_calc <span class="sc">*</span> se_b1</span>
<span id="cb36-14"><a href="rls.html#cb36-14" tabindex="-1"></a></span>
<span id="cb36-15"><a href="rls.html#cb36-15" tabindex="-1"></a><span class="fu">c</span>(<span class="at">LI =</span> inferior, <span class="at">beta1 =</span> b1, <span class="at">LS =</span> superior)</span></code></pre></div>
</details>
<pre><code>##    LI.Edad beta1.Edad    LS.Edad 
## -0.2697692 -0.2437636 -0.2177580</code></pre>
<ul>
<li>Ahora, verifiquemos la prueba de hipótesis <span class="math inline">\(H_0:\beta_1=0\, vs\, H_1:\beta_1\neq 0\)</span></li>
</ul>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="rls.html#cb38-1" tabindex="-1"></a><span class="co"># Pendiente</span></span>
<span id="cb38-2"><a href="rls.html#cb38-2" tabindex="-1"></a>b1 <span class="ot">&lt;-</span> <span class="fu">coef</span>(modelo)[<span class="dv">2</span>]</span>
<span id="cb38-3"><a href="rls.html#cb38-3" tabindex="-1"></a></span>
<span id="cb38-4"><a href="rls.html#cb38-4" tabindex="-1"></a><span class="co"># Varianza y error estándar de beta1</span></span>
<span id="cb38-5"><a href="rls.html#cb38-5" tabindex="-1"></a>var_b1 <span class="ot">&lt;-</span> sigma_hat<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> Sxx</span>
<span id="cb38-6"><a href="rls.html#cb38-6" tabindex="-1"></a>se_b1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(var_b1)</span>
<span id="cb38-7"><a href="rls.html#cb38-7" tabindex="-1"></a></span>
<span id="cb38-8"><a href="rls.html#cb38-8" tabindex="-1"></a><span class="co"># Hipótesis: H0: beta1 = 0 vs H1: beta1 != 0</span></span>
<span id="cb38-9"><a href="rls.html#cb38-9" tabindex="-1"></a>t_calc <span class="ot">&lt;-</span> (b1 <span class="sc">-</span> <span class="dv">0</span>) <span class="sc">/</span> se_b1</span>
<span id="cb38-10"><a href="rls.html#cb38-10" tabindex="-1"></a>gl <span class="ot">&lt;-</span> n <span class="sc">-</span> <span class="dv">2</span></span>
<span id="cb38-11"><a href="rls.html#cb38-11" tabindex="-1"></a>p_valor<span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(<span class="fu">abs</span>(t_calc), gl))</span></code></pre></div>
</details>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="rls.html#cb39-1" tabindex="-1"></a><span class="co"># Organizar resultados en data.frame</span></span>
<span id="cb39-2"><a href="rls.html#cb39-2" tabindex="-1"></a>resultados_b1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb39-3"><a href="rls.html#cb39-3" tabindex="-1"></a>  <span class="at">beta1_hat =</span> b1,</span>
<span id="cb39-4"><a href="rls.html#cb39-4" tabindex="-1"></a>  <span class="at">se_beta1 =</span> se_b1,</span>
<span id="cb39-5"><a href="rls.html#cb39-5" tabindex="-1"></a>  <span class="at">estadistico_t =</span> t_calc,</span>
<span id="cb39-6"><a href="rls.html#cb39-6" tabindex="-1"></a>  <span class="at">gl =</span> gl,</span>
<span id="cb39-7"><a href="rls.html#cb39-7" tabindex="-1"></a>  <span class="at">p_value =</span> p_valor</span>
<span id="cb39-8"><a href="rls.html#cb39-8" tabindex="-1"></a>)</span>
<span id="cb39-9"><a href="rls.html#cb39-9" tabindex="-1"></a></span>
<span id="cb39-10"><a href="rls.html#cb39-10" tabindex="-1"></a><span class="co"># Mostrar tabla</span></span>
<span id="cb39-11"><a href="rls.html#cb39-11" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(resultados_b1, <span class="at">digits =</span> <span class="dv">4</span>,</span>
<span id="cb39-12"><a href="rls.html#cb39-12" tabindex="-1"></a>             <span class="at">caption =</span> <span class="st">&quot;Prueba de hipótesis para β₁ (pendiente)&quot;</span>)</span></code></pre></div>
</details>
<table>
<caption><span id="tab:b6">Tabla 7.2: </span>Prueba de hipótesis para β₁ (pendiente)</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">beta1_hat</th>
<th align="right">se_beta1</th>
<th align="right">estadistico_t</th>
<th align="right">gl</th>
<th align="right">p_value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Edad</td>
<td align="right">-0.2438</td>
<td align="right">0.0131</td>
<td align="right">-18.6014</td>
<td align="right">98</td>
<td align="right">0</td>
</tr>
</tbody>
</table>
<hr />
<ul>
<li>Para probar si los calculos paso a paso estan correcto usamos las siguientes instrucciones:</li>
</ul>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="rls.html#cb40-1" tabindex="-1"></a><span class="co"># estadísticos de prueba para beta_0 y beta_1</span></span>
<span id="cb40-2"><a href="rls.html#cb40-2" tabindex="-1"></a><span class="fu">coefficients</span>(<span class="fu">summary</span>(modelo))</span></code></pre></div>
</details>
<pre><code>##               Estimate Std. Error   t value     Pr(&gt;|t|)
## (Intercept) 15.7427499 0.17868164  88.10502 3.989520e-95
## Edad        -0.2437636 0.01310455 -18.60144 6.394519e-34</code></pre>
<p>De acuerdo con los resultados de la regresión lineal simple, se observa que</p>
<ul>
<li><p>Para el intercepto (<span class="math inline">\(\beta_0\)</span>): con una confianza del <span class="math inline">\(95\%\)</span>, podemos decir el intercepto de la regresión lineal es significativo (<span class="math inline">\(t_{(98)}=88.11, p-valor &lt; 0.001\)</span>)</p></li>
<li><p>Para la pendiente (<span class="math inline">\(\beta_1\)</span>): con una confianza del <span class="math inline">\(95\%\)</span>, podemos afirmar que la pendiente asociada a la variable <strong>Edad</strong> es significativa (<span class="math inline">\(t_{(98)} = -18.60,\; p-valor &lt; 0.001\)</span>), lo cual indica que existe una relación negativa entre Edad y Resistencia.</p></li>
</ul>
<blockquote>
<p>En conclusión, ambos coeficientes resultan significativos al nivel del <span class="math inline">\(5\%\)</span> (e incluso a niveles mucho más estrictos), lo que confirma que el modelo de regresión lineal simple es adecuado para explicar la relación entre <strong>Edad</strong> y <strong>Resistencia</strong>.</p>
</blockquote>
<ul>
<li>Para el mismo nivel de significancia, los intervalos de confianza pueden calcularse como en <strong>R</strong> a través de la función <code>confint.default</code>:</li>
</ul>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="rls.html#cb42-1" tabindex="-1"></a><span class="co"># intervalos de confianza via confint</span></span>
<span id="cb42-2"><a href="rls.html#cb42-2" tabindex="-1"></a><span class="fu">confint.default</span>(modelo)</span></code></pre></div>
</details>
<pre><code>##                 2.5 %     97.5 %
## (Intercept) 15.392540 16.0929595
## Edad        -0.269448 -0.2180791</code></pre>
<ul>
<li><p>Para el intercepto (<span class="math inline">\(\beta_0\)</span>): con una confianza del <span class="math inline">\(95\%\)</span>, el intervalo de confianza es <span class="math inline">\((15.39,\;16.09)\)</span>. Como este intervalo no contiene el valor <span class="math inline">\(0\)</span>, podemos concluir que el intercepto es <strong>significativo</strong> en el modelo.</p></li>
<li><p>Para la pendiente (<span class="math inline">\(\beta_1\)</span>): con una confianza del <span class="math inline">\(95\%\)</span>, el intervalo de confianza es <span class="math inline">\((-0.269,\;-0.218)\)</span>. Como el intervalo no incluye el valor <span class="math inline">\(0\)</span>, concluimos que la pendiente es <strong>estadísticamente significativa</strong>. Además, el signo negativo indica que existe una relación <strong>inversa</strong> entre la variable <strong>Edad</strong> y la variable <strong>Resistencia</strong>: a mayor Edad, menor Resistencia.</p></li>
</ul>
<blockquote>
<p>En conclusión, tanto el intercepto como la pendiente resultan significativos al <span class="math inline">\(95\%\)</span> de confianza, lo que respalda la validez del modelo de regresión lineal simple para explicar la relación entre <strong>Edad</strong> y <strong>Resistencia</strong>.</p>
</blockquote>
</div>
</div>
<div id="anova-en-regresión-lineal" class="section level3 hasAnchor" number="7.6.7">
<h3><span class="header-section-number">7.6.7</span> ANOVA en regresión lineal<a href="#anova-en-regresi%C3%B3n-lineal" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>El objetivo del ANOVA en el contexto de la regresión lineal es evaluar si el modelo, en su conjunto, explica una proporción significativa de la variabilidad de la variable respuesta <span class="math inline">\(Y\)</span>.</p>
<div id="descomposición-de-la-variabilidad" class="section level4 hasAnchor" number="7.6.7.1">
<h4><span class="header-section-number">7.6.7.1</span> Descomposición de la variabilidad<a href="#descomposici%C3%B3n-de-la-variabilidad" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>La suma total de cuadrados (SST) puede descomponerse en:</p>
<p><span class="math display">\[SST = SSR + SSE\]</span></p>
<ul>
<li><span class="math inline">\(SST\)</span>: variabilidad total de <span class="math inline">\(Y\)</span>.<br />
</li>
<li><span class="math inline">\(SSR\)</span>: variabilidad explicada por el modelo (regresión).<br />
</li>
<li><span class="math inline">\(SSE\)</span>: variabilidad no explicada (error o residuos).</li>
</ul>
<p>Los grados de libertad se calculan de la siguiente manera</p>
<ul>
<li><span class="math inline">\(gl_{T} = n-1\)</span><br />
</li>
<li><span class="math inline">\(gl_{R} = k\)</span> (número de predictores; en RLS simple <span class="math inline">\(k=1\)</span>)<br />
</li>
<li><span class="math inline">\(gl_{E} = n-k-1\)</span></li>
</ul>
</div>
<div id="estadístico-f" class="section level4 hasAnchor" number="7.6.7.2">
<h4><span class="header-section-number">7.6.7.2</span> Estadístico <span class="math inline">\(F\)</span><a href="#estad%C3%ADstico-f" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>El estadístico de prueba se construye como:</p>
<p><span class="math display">\[F = \frac{MSR}{MSE}
= \frac{SSR / gl_R}{SSE / gl_E}
\sim F_{(gl_R,\;gl_E)} \quad \text{bajo } H_0\]</span></p>
<p>donde:</p>
<ul>
<li><span class="math inline">\(MSR\)</span>: cuadrado medio de la regresión.<br />
</li>
<li><span class="math inline">\(MSE\)</span>: cuadrado medio del error.</li>
</ul>
</div>
</div>
<div id="hipótesis-global" class="section level3 hasAnchor" number="7.6.8">
<h3><span class="header-section-number">7.6.8</span> Hipótesis global<a href="#hip%C3%B3tesis-global" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><span class="math display">\[
H_0:\ \beta_1=0
\quad\text{vs.}\quad
H_1:\ \beta_1 \neq 0
\]</span></p>
<p>Rechazar <span class="math inline">\(H_0\)</span> indica que el modelo explica una parte significativa de la variabilidad de <span class="math inline">\(Y\)</span>.</p>
<div class="admon-box nota">
<div class="admon-title">
<span class="icon"></span> Interpretación práctica de <span class="math inline">\(F_{calculado}\)</span>
</div>
<ol>
<li>
<strong><span class="math inline">\(F_{calc} \ll 1\)</span></strong>: los factores incontrolables explican mucho más que el factor controlable <span class="math inline">\(X\)</span>. Conviene explorar otro predictor.
</li>
<li>
<strong><span class="math inline">\(F_{calc} \approx 1\)</span></strong>: la variabilidad de <span class="math inline">\(Y\)</span> explicada por el factor controlable y por los factores incontrolables es similar. El predictor actual apenas aporta al modelo.
</li>
<li>
<strong><span class="math inline">\(F_{calc} \gg 1\)</span></strong>: la mayor parte de la variabilidad de <span class="math inline">\(Y\)</span> se explica por el factor controlable <span class="math inline">\(X\)</span> más que por los factores incontrolables. Este es el caso ideal.
</li>
</ol>
</div>
<ul>
<li>Continuando con el ejemplo de soldadura</li>
</ul>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="rls.html#cb44-1" tabindex="-1"></a><span class="co"># Ajustar modelo de regresión</span></span>
<span id="cb44-2"><a href="rls.html#cb44-2" tabindex="-1"></a>modelo <span class="ot">&lt;-</span> <span class="fu">lm</span>(Resistencia <span class="sc">~</span> Edad, <span class="at">data =</span> df)</span>
<span id="cb44-3"><a href="rls.html#cb44-3" tabindex="-1"></a></span>
<span id="cb44-4"><a href="rls.html#cb44-4" tabindex="-1"></a><span class="co"># ANOVA del modelo</span></span>
<span id="cb44-5"><a href="rls.html#cb44-5" tabindex="-1"></a><span class="fu">anova</span>(modelo)</span></code></pre></div>
</details>
<pre><code>## Analysis of Variance Table
## 
## Response: Resistencia
##           Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
## Edad       1 120.802 120.802  346.01 &lt; 2.2e-16 ***
## Residuals 98  34.214   0.349                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<ul>
<li>A partir del ajuste del modelo de Regresión Lineal Simple, se obtuvo el siguiente estadístico:</li>
</ul>
<blockquote>
<p>Dado que el <span class="math inline">\(p-valor &lt; 0.001\)</span> es muchísimo menor que el nivel de significancia usual (<span class="math inline">\(\alpha = 0.05\)</span>), se <strong>rechaza la hipótesis nula</strong> y se concluye que el modelo ajustado es <strong>globalmente significativo</strong>. En otras palabras, la variable <strong>Edad</strong> contribuye de manera estadísticamente significativa a explicar la variabilidad de la variable <strong>Resistencia</strong>.</p>
</blockquote>
<hr />
<ul>
<li>Para obtener todo lo desarrollado paso a paso de cada una de las estimaciones podemos realizar el siguiente paso:</li>
</ul>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="rls.html#cb46-1" tabindex="-1"></a><span class="fu">summary</span>(modelo)</span></code></pre></div>
</details>
<pre><code>## 
## Call:
## lm(formula = Resistencia ~ Edad, data = df)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.6852 -0.3543  0.0209  0.4225  1.8004 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  15.7427     0.1787   88.11   &lt;2e-16 ***
## Edad         -0.2438     0.0131  -18.60   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.5909 on 98 degrees of freedom
## Multiple R-squared:  0.7793, Adjusted R-squared:  0.777 
## F-statistic:   346 on 1 and 98 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div id="transformaciones-para-mejorar-el-ajuste-del-modelo" class="section level2 hasAnchor" number="7.7">
<h2><span class="header-section-number">7.7</span> Transformaciones para mejorar el ajuste del modelo<a href="rls.html#transformaciones-para-mejorar-el-ajuste-del-modelo" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>En este capítulo se explora cómo las <strong>transformaciones matemáticas</strong> aplicadas a la <strong>variable respuesta (<code>Y</code>)</strong> o a las <strong>covariables (<code>X</code>)</strong> pueden ser utilizadas para <strong>mejorar el ajuste de un modelo lineal</strong>. Cuando los datos no presentan una relación lineal directa, estas transformaciones permiten acercar el comportamiento observado a uno que sí pueda ser representado por un modelo lineal clásico, facilitando así su análisis e interpretación.</p>
<div id="por-qué-transformar-variables" class="section level3 hasAnchor" number="7.7.1">
<h3><span class="header-section-number">7.7.1</span> ¿Por qué transformar variables?<a href="#por-qu%C3%A9-transformar-variables" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>En muchos casos, el modelo teórico que relaciona <code>Y</code> con <code>X</code> no es estrictamente lineal. Sin embargo, mediante transformaciones adecuadas, es posible <strong>linealizar la relación</strong>, de modo que el modelo ajustado en la nueva escala cumpla con los supuestos de regresión lineal (como homocedasticidad, normalidad de errores, y linealidad).</p>
<p>Estas transformaciones son particularmente útiles cuando:</p>
<ul>
<li>Se detecta <strong>curvatura</strong> en los residuos.</li>
<li>La <strong>dispersión de los errores</strong> aumenta con el valor de <code>X</code> o <code>Y</code>.</li>
<li>El <strong>modelo lineal muestra falta de ajuste significativa</strong>.</li>
<li>Se busca <strong>estabilizar la varianza</strong> o <strong>mejorar la normalidad</strong> de los residuos.</li>
</ul>
</div>
<div id="tipos-comunes-de-transformaciones" class="section level3 hasAnchor" number="7.7.2">
<h3><span class="header-section-number">7.7.2</span> Tipos comunes de transformaciones<a href="rls.html#tipos-comunes-de-transformaciones" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A continuación se presentan algunos tipos comunes de transformaciones para <code>X</code> o <code>Y</code> que permiten linealizar relaciones no lineales:</p>
<table>
<colgroup>
<col width="38%" />
<col width="30%" />
<col width="31%" />
</colgroup>
<thead>
<tr class="header">
<th>Forma original del modelo no lineal</th>
<th>Transformación sugerida</th>
<th>Modelo lineal equivalente</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(Y = a \cdot X^b\)</span></td>
<td><code>log(Y) ~ log(X)</code></td>
<td>Log-log (modelo potencial)</td>
</tr>
<tr class="even">
<td><span class="math inline">\(Y = a \cdot e^{bX}\)</span></td>
<td><code>log(Y) ~ X</code></td>
<td>Log-lineal (modelo exponencial)</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(Y = \frac{1}{a + bX}\)</span></td>
<td><code>1/Y ~ X</code></td>
<td>Inverso de Y</td>
</tr>
<tr class="even">
<td><span class="math inline">\(Y = a + b \cdot \log(X)\)</span></td>
<td><code>Y ~ log(X)</code></td>
<td>Lineal en log(X)</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(Y^2 = a + bX\)</span></td>
<td><code>sqrt(Y) ~ X</code> o <code>Y^2 ~ X</code></td>
<td>Transformación raíz o cuadrática</td>
</tr>
<tr class="even">
<td><span class="math inline">\(Y = a + b \cdot \sqrt{X}\)</span></td>
<td><code>Y ~ sqrt(X)</code></td>
<td>Lineal en raíz cuadrada de X</td>
</tr>
</tbody>
</table>
<blockquote>
<p>La elección de la transformación debe basarse tanto en criterios teóricos como empíricos (exploración visual, pruebas de falta de ajuste, etc.).</p>
</blockquote>
</div>
<div id="evaluación-posterior-a-la-transformación" class="section level3 hasAnchor" number="7.7.3">
<h3><span class="header-section-number">7.7.3</span> Evaluación posterior a la transformación<a href="#evaluaci%C3%B3n-posterior-a-la-transformaci%C3%B3n" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Una vez aplicado el cambio de escala, es indispensable:</p>
<ul>
<li>Volver a <strong>graficar la relación</strong> entre las variables transformadas.</li>
<li>Revisar los <strong>residuos del nuevo modelo</strong>.</li>
<li>Evaluar si la transformación <strong>mejoró la linealidad y redujo la falta de ajuste</strong>.</li>
<li>Si es necesario hacer predicciones, aplicar una <strong>retrotransformación</strong> para volver a la escala original de la variable respuesta.</li>
</ul>
<div id="transformación-de-la-variable-explicativa" class="section level4 hasAnchor" number="7.7.3.1">
<h4><span class="header-section-number">7.7.3.1</span> Transformación de la variable explicativa<a href="#transformaci%C3%B3n-de-la-variable-explicativa" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>En este caso, usarás el conjunto de datos <code>taiwan_real_estate</code>, y tomarás como variable explicativa la <strong>distancia a la estación de metro más cercana</strong> (<code>dist_to_mrt_m</code>), aplicando una transformación de raíz cuadrada. El objetivo es observar si la relación con el precio por metro cuadrado (<code>price_twd_msq</code>) mejora.</p>
<ul>
<li>Carguemos los datos</li>
</ul>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="rls.html#cb48-1" tabindex="-1"></a><span class="fu">library</span>(fst)</span>
<span id="cb48-2"><a href="rls.html#cb48-2" tabindex="-1"></a></span>
<span id="cb48-3"><a href="rls.html#cb48-3" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;data/taiwan_real_estate.fst&quot;</span>)</span>
<span id="cb48-4"><a href="rls.html#cb48-4" tabindex="-1"></a>taiwan_real_estate <span class="ot">&lt;-</span> <span class="fu">read_fst</span>(file_path)</span>
<span id="cb48-5"><a href="rls.html#cb48-5" tabindex="-1"></a></span>
<span id="cb48-6"><a href="rls.html#cb48-6" tabindex="-1"></a><span class="co"># convertirlo en un factor </span></span>
<span id="cb48-7"><a href="rls.html#cb48-7" tabindex="-1"></a>taiwan_real_estate<span class="sc">$</span>house_age_years <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(taiwan_real_estate<span class="sc">$</span>house_age_years)</span>
<span id="cb48-8"><a href="rls.html#cb48-8" tabindex="-1"></a></span>
<span id="cb48-9"><a href="rls.html#cb48-9" tabindex="-1"></a><span class="co"># muestra las 3 primeras filas</span></span>
<span id="cb48-10"><a href="rls.html#cb48-10" tabindex="-1"></a><span class="fu">head</span>(taiwan_real_estate, <span class="dv">3</span>)</span></code></pre></div>
</details>
<pre><code>##   dist_to_mrt_m n_convenience house_age_years price_twd_msq
## 1      84.87882            10        30 to 45      11.46747
## 2     306.59470             9        15 to 30      12.76853
## 3     561.98450             5         0 to 15      14.31165</code></pre>
<ul>
<li>Visualicemos la relación original</li>
</ul>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="rls.html#cb50-1" tabindex="-1"></a>taiwan_real_estate <span class="sc">%&gt;%</span> </span>
<span id="cb50-2"><a href="rls.html#cb50-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(dist_to_mrt_m, price_twd_msq)) <span class="sc">+</span></span>
<span id="cb50-3"><a href="rls.html#cb50-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb50-4"><a href="rls.html#cb50-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb50-5"><a href="rls.html#cb50-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Relacion original: distancia vs. precio&quot;</span>)<span class="sc">+</span></span>
<span id="cb50-6"><a href="rls.html#cb50-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
</details>
<p><img src="bookdown-demo_files/figure-html/v2-1.png" width="672" /></p>
<ul>
<li>Ajustando el modelo de línea recta tenemos</li>
</ul>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="rls.html#cb51-1" tabindex="-1"></a>modelo1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(price_twd_msq<span class="sc">~</span> dist_to_mrt_m, <span class="at">data=</span>taiwan_real_estate)</span></code></pre></div>
</details>
<ul>
<li>El resumen del <code>modelo1</code> es</li>
</ul>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="rls.html#cb52-1" tabindex="-1"></a><span class="fu">summary</span>(modelo1)</span></code></pre></div>
</details>
<pre><code>## 
## Call:
## lm(formula = price_twd_msq ~ dist_to_mrt_m, data = taiwan_real_estate)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -10.7097  -1.8177  -0.3617   1.4616  22.2338 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   13.8733516  0.1974616   70.26   &lt;2e-16 ***
## dist_to_mrt_m -0.0021973  0.0001188  -18.50   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.046 on 412 degrees of freedom
## Multiple R-squared:  0.4538, Adjusted R-squared:  0.4524 
## F-statistic: 342.2 on 1 and 412 DF,  p-value: &lt; 2.2e-16</code></pre>
<ul>
<li><p>Del resultado anterior se observa que</p>
<ul>
<li><p>La <strong>distancia a la estación de metro más cercana (dist_to_mrt_m)</strong> es significativa por que el <span class="math inline">\(p-valor &lt; 0.0001\)</span>. Esto indica que existe evidencia estadística suficiente para afirmar que la distancia al metro influye en el precio por metro cuadrado.</p></li>
<li><p>El coeficiente asociado a <code>dist_to_mrt_m</code> es <span class="math inline">\(-0.0021973\)</span>, lo que indica que por cada metro adicional que se aleja una propiedad de la estación de metro, el precio por metro cuadrado disminuye en promedio 0.0022 millones de <span class="math inline">\(TWD/m^2\)</span> (o sea, aproximadamente 2.197 <span class="math inline">\(TWD/m^2\)</span>). En otras palabras, <strong>a mayor distancia al metro, menor precio</strong>, lo cual tiene sentido desde un punto de vista urbano y económico.</p></li>
<li><p>El coeficiente de determinación <span class="math inline">\(R^2=0.4538\)</span> indica que el modelo explica aproximadamente el <span class="math inline">\(45.38\%\)</span> de la variabilidad en el precio por metro cuadrado.</p></li>
<li><p>El modelo es <strong>estadísticamente significativo</strong> en su conjunto, ya que el <span class="math inline">\(p-valor\)</span> del estadístico <span class="math inline">\(F\)</span> es <span class="math inline">\(&lt;0.001\)</span>.</p></li>
<li><p>El error estándar residual (3.046) sugiere una dispersión moderada de los residuos alrededor de la recta de regresión.</p></li>
</ul></li>
</ul>
<hr />
<p>Ahora, si deseamos ajustar el modelo para mejorar el coeficiente de determinación, es necesario transformar la variable independiente, es decir, vamos a entrenar el modelo con <span class="math inline">\(X* = \sqrt{X}\)</span>.</p>
<ul>
<li>Transformemos la variable explicativa (raíz cuadrada)</li>
</ul>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="rls.html#cb54-1" tabindex="-1"></a>taiwan_real_estate <span class="sc">%&gt;%</span> </span>
<span id="cb54-2"><a href="rls.html#cb54-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="fu">sqrt</span>(dist_to_mrt_m), price_twd_msq)) <span class="sc">+</span></span>
<span id="cb54-3"><a href="rls.html#cb54-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb54-4"><a href="rls.html#cb54-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb54-5"><a href="rls.html#cb54-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Transformacion: raiz cuadrada de la distancia vs. precio&quot;</span>)<span class="sc">+</span></span>
<span id="cb54-6"><a href="rls.html#cb54-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
</details>
<p><img src="bookdown-demo_files/figure-html/v5-1.png" width="672" /></p>
<ul>
<li><p>Observa si los puntos siguen mejor la línea de regresión después de la transformación. Si es así, el modelo lineal será más adecuado</p></li>
<li><p>Ajustemos el modelo</p></li>
</ul>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="rls.html#cb55-1" tabindex="-1"></a>modelo2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(price_twd_msq<span class="sc">~</span> <span class="fu">sqrt</span>(dist_to_mrt_m), <span class="at">data=</span>taiwan_real_estate)</span></code></pre></div>
</details>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="rls.html#cb56-1" tabindex="-1"></a><span class="fu">summary</span>(modelo2) </span></code></pre></div>
</details>
<pre><code>## 
## Call:
## lm(formula = price_twd_msq ~ sqrt(dist_to_mrt_m), data = taiwan_real_estate)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -10.7843  -1.5410  -0.2594   1.2294  21.7483 
## 
## Coefficients:
##                      Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)         16.709799   0.277741   60.16   &lt;2e-16 ***
## sqrt(dist_to_mrt_m) -0.182843   0.008436  -21.67   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.818 on 412 degrees of freedom
## Multiple R-squared:  0.5327, Adjusted R-squared:  0.5316 
## F-statistic: 469.7 on 1 and 412 DF,  p-value: &lt; 2.2e-16</code></pre>
<ul>
<li><p>De la tabla de coeficientes del modelo se observa que:</p>
<ul>
<li><p>La variable <code>sqrt(dist_to_mrt_m)</code> es estadísticamente significativa, ya que su <span class="math inline">\(p-valor &lt; 0.0001\)</span>.</p></li>
<li><p>Por cada unidad que aumenta la raíz cuadrada de la distancia a la estación de MRT (<code>sqrt(dist_to_mrt_m</code>)), el valor de la variable dependiente disminuye en 0.182843 unidades, manteniendo constante el resto de variables.</p></li>
<li><p>El modelo presenta un <span class="math inline">\(R^2\)</span> de 0.5327, lo cual indica que aproximadamente el <span class="math inline">\(53.27\%\)</span> de la variabilidad en la variable de respuesta puede ser explicada por <code>sqrt(dist_to_mrt_m)</code>.</p></li>
<li><p>El modelo es altamente significativo en su conjunto, como lo demuestra el estadístico <span class="math inline">\(F = 469.7\)</span> y el <span class="math inline">\(p-valor &lt; 0.001\)</span>.</p></li>
<li><p>El error estándar residual (2.818) sugiere una dispersión moderada de los residuos alrededor de la recta de regresión.</p></li>
</ul></li>
</ul>
</div>
<div id="transformación-de-la-variable-de-respuesta" class="section level4 hasAnchor" number="7.7.3.2">
<h4><span class="header-section-number">7.7.3.2</span> Transformación de la variable de respuesta<a href="#transformaci%C3%B3n-de-la-variable-de-respuesta" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>También es posible transformar la <strong>variable dependiente (respuesta)</strong>, por ejemplo cuando sus valores están muy sesgados o varían demasiado. Pero al hacerlo, se requiere luego una “<strong>retrotransformación</strong>” para volver a la escala original e interpretar correctamente.</p>
<p>En este caso, usarás el conjunto <code>ad_conversion</code>, con:</p>
<ul>
<li><p><code>n_impressions</code>: número de veces que se mostró el anuncio.</p></li>
<li><p><code>n_clicks</code>: número de clics recibidos.</p></li>
</ul>
<p>Se transformará ambas variables con una potencia 0.25 (raíz cuarta) para estabilizar la relación.</p>
<ul>
<li>Carguemos los datos</li>
</ul>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="rls.html#cb58-1" tabindex="-1"></a><span class="fu">library</span>(fst)</span>
<span id="cb58-2"><a href="rls.html#cb58-2" tabindex="-1"></a></span>
<span id="cb58-3"><a href="rls.html#cb58-3" tabindex="-1"></a>file_path <span class="ot">&lt;-</span> <span class="fu">file.path</span>(<span class="st">&quot;data/ad_conversion.fst&quot;</span>)</span>
<span id="cb58-4"><a href="rls.html#cb58-4" tabindex="-1"></a>ad_conversion <span class="ot">&lt;-</span> <span class="fu">read_fst</span>(file_path)</span>
<span id="cb58-5"><a href="rls.html#cb58-5" tabindex="-1"></a></span>
<span id="cb58-6"><a href="rls.html#cb58-6" tabindex="-1"></a><span class="co"># muestra las 3 primeras filas</span></span>
<span id="cb58-7"><a href="rls.html#cb58-7" tabindex="-1"></a><span class="fu">head</span>(ad_conversion, <span class="dv">3</span>)</span></code></pre></div>
</details>
<pre><code>##   spent_usd n_impressions n_clicks
## 1      1.43          7350        1
## 2      1.82         17861        2
## 3      1.25          4259        1</code></pre>
<ul>
<li>Visualicemos la relación original</li>
</ul>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="rls.html#cb60-1" tabindex="-1"></a>ad_conversion <span class="sc">%&gt;%</span> </span>
<span id="cb60-2"><a href="rls.html#cb60-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(n_impressions, n_clicks)) <span class="sc">+</span></span>
<span id="cb60-3"><a href="rls.html#cb60-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb60-4"><a href="rls.html#cb60-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb60-5"><a href="rls.html#cb60-5" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
</details>
<p><img src="bookdown-demo_files/figure-html/t2-1.png" width="672" /></p>
<ul>
<li>Ajustando el modelo de línea recta tenemos</li>
</ul>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="rls.html#cb61-1" tabindex="-1"></a>modelo1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(n_clicks <span class="sc">~</span> n_impressions,<span class="at">data =</span> ad_conversion)</span></code></pre></div>
</details>
<ul>
<li>El resumen del <code>modelo1</code> es</li>
</ul>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="rls.html#cb62-1" tabindex="-1"></a><span class="fu">summary</span>(modelo1)</span></code></pre></div>
</details>
<pre><code>## 
## Call:
## lm(formula = n_clicks ~ n_impressions, data = ad_conversion)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -186.099   -5.392   -1.422    2.070  119.876 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   1.683e+00  7.888e-01   2.133   0.0331 *  
## n_impressions 1.718e-04  1.960e-06  87.654   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 19.91 on 934 degrees of freedom
## Multiple R-squared:  0.8916, Adjusted R-squared:  0.8915 
## F-statistic:  7683 on 1 and 934 DF,  p-value: &lt; 2.2e-16</code></pre>
<ul>
<li><p>De la tabla anterior se observa que:</p>
<ul>
<li><p>La variable n<code>_impressions</code> es altamente significativa, ya que su <span class="math inline">\(p-valor &lt; 0.001\)</span>. Esto indica una fuerte evidencia estadística de que esta variable tiene un efecto sobre la variable dependiente.</p></li>
<li><p>Por cada impresión adicional, se espera que la variable dependiente (probablemente ingresos, clics o visitas, dependiendo del contexto) aumente en 0.0001718 unidades, manteniendo todo lo demás constante.</p></li>
<li><p>El <span class="math inline">\(R^2\)</span> es 0.8916, lo cual indica que el modelo explica el 89.16% de la variabilidad de la variable respuesta. Esto representa un ajuste excelente del modelo a los datos.</p></li>
<li><p>El modelo completo es significativo, ya que el <span class="math inline">\(p-valor\)</span> del estadístico <span class="math inline">\(F\)</span> también es menor a 0.001.</p></li>
<li><p>El error estándar residual (19.91) sugiere una dispersión alta de los residuos alrededor de la recta de regresión.</p></li>
</ul></li>
</ul>
<hr />
<ul>
<li>Transformemos la variable explicativa (raíz cuadrada)</li>
</ul>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="rls.html#cb64-1" tabindex="-1"></a>ad_conversion <span class="sc">%&gt;%</span> </span>
<span id="cb64-2"><a href="rls.html#cb64-2" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(n_impressions <span class="sc">^</span> <span class="fl">0.25</span>, n_clicks <span class="sc">^</span> <span class="fl">0.25</span>)) <span class="sc">+</span></span>
<span id="cb64-3"><a href="rls.html#cb64-3" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb64-4"><a href="rls.html#cb64-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> <span class="cn">FALSE</span>)<span class="sc">+</span></span>
<span id="cb64-5"><a href="rls.html#cb64-5" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
</details>
<p><img src="bookdown-demo_files/figure-html/t5-1.png" width="672" /></p>
<ul>
<li><p>Observa si los puntos siguen mejor la línea de regresión después de la transformación. Si es así, el modelo lineal será más adecuado</p></li>
<li><p>Ajustemos el modelo</p></li>
</ul>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="rls.html#cb65-1" tabindex="-1"></a>modelo2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb65-2"><a href="rls.html#cb65-2" tabindex="-1"></a>  <span class="fu">I</span>(n_clicks <span class="sc">^</span> <span class="fl">0.25</span>) <span class="sc">~</span> <span class="fu">I</span>(n_impressions <span class="sc">^</span> <span class="fl">0.25</span>),</span>
<span id="cb65-3"><a href="rls.html#cb65-3" tabindex="-1"></a>  <span class="at">data =</span> ad_conversion</span>
<span id="cb65-4"><a href="rls.html#cb65-4" tabindex="-1"></a>)</span></code></pre></div>
</details>
<details class=chunk-details open><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="rls.html#cb66-1" tabindex="-1"></a><span class="fu">summary</span>(modelo2) </span></code></pre></div>
</details>
<pre><code>## 
## Call:
## lm(formula = I(n_clicks^0.25) ~ I(n_impressions^0.25), data = ad_conversion)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.57061 -0.13229  0.00582  0.14494  0.46888 
## 
## Coefficients:
##                        Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)           0.0717479  0.0172019   4.171 3.32e-05 ***
## I(n_impressions^0.25) 0.1115330  0.0008844 126.108  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1969 on 934 degrees of freedom
## Multiple R-squared:  0.9445, Adjusted R-squared:  0.9445 
## F-statistic: 1.59e+04 on 1 and 934 DF,  p-value: &lt; 2.2e-16</code></pre>
<ul>
<li><p>La variable <code>I(n_impressions^0.25)</code> es altamente significativa (p &lt; 0.001), lo que indica una relación robusta con la variable dependiente.</p></li>
<li><p>Por cada unidad que aumenta <code>n_impressions^0.25</code>, la respuesta se incrementa en 0.1115 unidades, manteniendo constante el intercepto.</p></li>
<li><p>El modelo presenta un ajuste excelente, con un <span class="math inline">\(R^2\)</span> de 0.9445, lo que indica que explica el <span class="math inline">\(94.45\%\)</span> de la variabilidad observada.</p></li>
<li><p>El modelo es estadísticamente significativo en su conjunto (<span class="math inline">\(F = 15900, p-valor &lt; 0.001\)</span>).</p></li>
<li><p>El error estándar residual (0.1969) refleja una baja dispersión de los residuos respecto a la línea de ajuste.</p></li>
</ul>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="correglin.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="referencias-1.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/rstudio/bookdown-demo/edit/master/07-rls.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
